<!doctype html>
  <!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Tutorial: Making your first add-on - 홈어시스턴트</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Open source home automation that puts local control and privacy first.">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://hakorea.github.io/hassio/hassio_addon_tutorial/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Tutorial: Making your first add-on">
    <meta property="og:site_name" content="홈어시스턴트">
    <meta property="og:url" content="https://hakorea.github.io/hassio/hassio_addon_tutorial/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="Open source home automation that puts local control and privacy first.">
    <meta property="og:image" content="https://hakorea.github.io/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@">
    
    <meta name="twitter:title" content="Tutorial: Making your first add-on">
    <meta name="twitter:description" content="Open source home automation that puts local control and privacy first.">
    <meta name="twitter:image" content="https://hakorea.github.io/images/default-social.png">

    <link href="/stylesheets/prism.css?8acb84bc0387c9548a63998fcfea0139" rel="stylesheet">
    <link href="/stylesheets/screen.css?0a23d70030bf362ca935e76ccc50922c" media="screen, projection, print" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="홈어시스턴트" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
  </head>

  <body >

    <header class='site-header'>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="/" class="site-title">
        <img src="/images/home-assistant-logo.png" width="36" height="36" alt="Home Assistant">
        <span>홈어시스턴트</span>
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle">
        <label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
        <ul class="menu pull-right">
            
            <li><a href="/getting-started/">시작하기</a></li>
            <li><a href="/integrations/">통합구성요소</a></li>
            <li><a href="/docs/">문서</a></li>
            <li><a href="/cookbook/">예제</a></li>
            <li>KOREAN(not official)</li>
        </ul>
      </nav>

      <div class='search-container' style='display: none'>
        <div class='search'>
          <i class="icon-search"></i>
          <input id='search' placeholder='Search the docs…'>
          <a href='#' class='close'><i class="icon-remove-sign"></i></a>
        </div>
      </div>
    </div>
  </div>
</div>

    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          
            <article class="page">
  
  
    

<div class="edit-github"><a href="https://github.com/hakorea/gitpages_source/blob/master/source/hassio/hassio_addon_tutorial.markdown" rel="external nofollow">깃허브 편집</a></div>


  

  
  <header>
    <h1 class="title indent">
      Tutorial: Making your first add-on
    </h1>
  </header>
  <hr class="divider">
  

  <p>So you’ve got Home Assistant going and you’ve been enjoying the built-in add-ons but you’re missing this one application. Time to make your own add-on! In Hass.io 0.24 we introduced the option to have local add-ons be build on your device. This is great for developing new add-ons locally.</p>
<p>To get started with developing add-ons, we first need access to where Hass.io looks for local add-ons. For this you can use the Samba add-on or the SSH add-on.</p>
<p>For Samba, once you have enabled and started it, your Hass.io instance will show up in your local network tab and share a folder called “addons”. This is the folder to store your custom add-ons.</p>
<p>If you are on macOS and the folder is not showing up automatically, go to Finder and press CMD+K then enter ‘smb://hassio.local’</p>
<p><img src="/images/hassio/tutorial/samba.png" alt="Screenshot of Windows Explorer showing a folder on the Hass.io server"></p>
<p>For SSH, you will have to install it. Before you can start it, you will have to have a private/public key pair and store your public key in the add-on config (<a href="https://www.home-assistant.io/addons/ssh/">see docs for more info</a>). Once started, you can SSH to Hass.io and store your custom add-ons in “/addons”.</p>
<p><img src="/images/hassio/tutorial/ssh.png" alt="Screenshot of Putty connected to Hass.io"></p>
<p>Once you have located your add-on directory, it’s time to get started!</p>
<h2>
<a class="title-link" name="step-1-the-basics" href="#step-1-the-basics"></a> Step 1: The basics</h2>
<ul>
<li>Create a new directory called <code>hello_world</code>
</li>
<li>Inside that directory create three files.</li>
</ul>
<p><code>Dockerfile</code>:</p>
<pre><code class="language-dockerfile">ARG BUILD_FROM
FROM $BUILD_FROM

ENV LANG C.UTF-8

# Copy data for add-on
COPY run.sh /
RUN chmod a+x /run.sh

CMD [ "/run.sh" ]
</code></pre>
<p><code>config.json</code>:</p>
<pre><code class="language-json">{
  "name": "Hello world",
  "version": "1",
  "slug": "hello_world",
  "description": "My first real add-on!",
  "arch": ["armhf", "armv7", "aarch64", "amd64", "i386"],
  "startup": "before",
  "boot": "auto",
  "options": {},
  "schema": {}
}
</code></pre>
<p><code>run.sh</code>:</p>
<pre><code class="language-shell">echo Hello world!
</code></pre>
<p>Make sure your editor is using UNIX-like line breaks (LF), not Dos/Windows (CRLF).</p>
<h2>
<a class="title-link" name="step-2-installing-and-testing-your-add-on" href="#step-2-installing-and-testing-your-add-on"></a> Step 2: Installing and testing your add-on</h2>
<p>Now comes the fun part, time to open the Hass.io UI and install and run your add-on.</p>
<ul>
<li>Open the Home Assistant frontend</li>
<li>Go to the Hass.io panel</li>
<li>On the top right click the shopping basket to go to the add-on store.</li>
</ul>
<p><img src="/images/hassio/screenshots/main_panel_addon_store.png" alt="Screenshot of the Hass.io main panel"></p>
<ul>
<li>On the top right click the refresh button</li>
<li>You should now see a new card called “Local” that lists your add-on!</li>
</ul>
<p><img src="/images/hassio/screenshots/local_repository.png" alt="Screenshot of the local repository card"></p>
<ul>
<li>Click on your add-on to go to the add-on details page.</li>
<li>Install your add-on</li>
<li>Start your add-on</li>
<li>Refresh the logs of your add-on, you should now see “Hello world!” in your logs.</li>
</ul>
<p><img src="/images/hassio/tutorial/addon_hello_world_logs.png" alt="Screenshot of the add-on logs"></p>
<h3>
<a class="title-link" name="i-dont-see-my-add-on" href="#i-dont-see-my-add-on"></a> I don’t see my add-on?!</h3>
<p>Oops! You clicked refresh in the store and your add-on didn’t show up. Or maybe you just updated an option, clicked refresh and saw your add-on disappear.</p>
<p>When this happens, it means that your <code>config.json</code> is invalid. It’s either invalid JSON or one of the specified options is incorrect. To see what went wrong, go to the Hass.io panel and in the supervisor card click on “View logs”. This should bring you to a page with the logs of the supervisor. Scroll to the bottom and you should be able to find the validation error.</p>
<p>Once you fixed the error, go to the add-on store and click refresh again.</p>
<h2>
<a class="title-link" name="step-3-hosting-a-server" href="#step-3-hosting-a-server"></a> Step 3: Hosting a server</h2>
<p>Until now we’ve been able to do some basic stuff, but it’s not very useful yet. So let’s take it one step further and host a server that we expose on a port. For this we’re going to use the built-in HTTP server that comes with Python 3.</p>
<p>To do this, we will need to update our files as follows:</p>
<ul>
<li>
<code>Dockerfile</code>: Install Python 3</li>
<li>
<code>config.json</code>: Make the port from the container available on the host</li>
<li>
<code>run.sh</code>: Run the Python 3 command to start the HTTP server</li>
</ul>
<p>Add to your <code>Dockerfile</code> before <code>RUN</code>:</p>
<pre><code class="language-dockerfile"># Install requirements for add-on
RUN apk add --no-cache python3

# Python 3 HTTP Server serves the current working dir
# So let's set it to our add-on persistent data directory.
WORKDIR /data
</code></pre>
<p>Add “ports” to <code>config.json</code>. This will make TCP on port 8000 inside the container available on the host on port 8000.</p>
<pre><code class="language-json">{
  "name": "Hello world",
  "version": "0.2",
  "slug": "hello_world",
  "description": "My first real add-on!",
  "arch": ["armhf", "armv7", "aarch64", "amd64", "i386"],
  "startup": "before",
  "boot": "auto",
  "options": {},
  "schema": {},
  "ports": {
    "8000/tcp": 8000
  }
}
</code></pre>
<p>Update <code>run.sh</code> to start the Python 3 server:</p>
<pre><code class="language-shell">python3 -m http.server 8000
</code></pre>
<h2>
<a class="title-link" name="step-4-installing-the-update" href="#step-4-installing-the-update"></a> Step 4: Installing the update</h2>
<p>Since we updated the version number in our <code>config.json</code>, Home Assistant will show an update button when looking at the add-on details. You might have to refresh your browser or click the refresh button in the add-on store for it to show up. If you did not update the version number, you can also uninstall and install the add-on again. After installing the add-on again, make sure you start it.</p>
<p>Now navigate to <a href="http://hassio.local:8000" rel="external nofollow">http://hassio.local:8000</a> to see our server in action!</p>
<p><img src="/images/hassio/tutorial/python3-http-server.png" alt="Screenshot of the file index served by the add-on"></p>
<h2>
<a class="title-link" name="bonus-working-with-add-on-options" href="#bonus-working-with-add-on-options"></a> Bonus: Working with add-on options</h2>
<p>In the screenshot you’ve probably seen that our server only served up 1 file: <code>options.json</code>. This file contains the user configuration for this add-on. Because we specified an empty “config” and “schema” in our <code>config.json</code>, the file is currently empty.</p>
<p>Let’s see if we can get some data into that file!</p>
<p>To do this, we need to specify the default options and a schema for the user to change the options.</p>
<p>Change the options and schema entries in your <code>config.json</code> with the following:</p>
<pre><code class="language-json">{
  …

  "options": {
    "beer": true,
    "wine": true,
    "liquor": false,
    "name": "world",
    "year": 2017
  },
  "schema": {
    "beer": "bool",
    "wine": "bool",
    "liquor": "bool",
    "name": "str",
    "year": "int"
  },

  …
}
</code></pre>
<p>Refresh the add-on store and re-install your add-on. You will now see the options available in the add-on config screen. When you now go back to our Python 3 server and download <code>options.json</code>, you’ll see the options you set. <a href="https://github.com/home-assistant/hassio-addons/blob/master/mosquitto/data/run.sh#L4-L5" rel="external nofollow">Example of how options.json can be used inside <code>run.sh</code></a></p>
<h3><a href="/hassio/hassio_addon_config/">다음 과정: 애드온 설정 »</a></h3>


</article>

          
        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">
  
  
    <section class="aside-module grid__item one-whole lap-one-half">
  <div class='section'>
    <h1 class="title delta">목차</h1>
    <ul class='divided sidebar-menu'>
      <li>
        <a  href='/hassio/'>Hass.io </a>
        <ul>
          <li><a  href='/hassio/installation/'>설치 </a></li>
          <li><a  href='/addons/'>애드온 </a></li>
          <li><a  href='/hassio/installing_third_party_addons/'>서드파티 애드온 </a></li>
        </ul>
      </li>
    </ul>
    <ul class='divided sidebar-menu'>
      <li>
        고급 설정
        <ul>
          <li><a  href='/hassio/commandline/'>명령어 모드 </a></li>
          <li><a  href='/hassio/zwave/'>Z-Wave </a></li>
          <li><a  href='/hassio/enable_i2c/'>I2C 사용 </a></li>
        </ul>
      </li>
    </ul>
    <ul class='divided sidebar-menu'>
      <li><a  href='/hassio/developing_addon/'>애드온을 제작하려면? </a>
        <ol>
          <li><a class='active' href='/hassio/hassio_addon_tutorial/'>무작정 따라해보기 </a></li>
          <li><a  href='/hassio/hassio_addon_config/'>애드온 설정 </a></li>
          <li><a  href='/hassio/hassio_addon_communication/'>통신 방법 </a></li>
          <li><a  href='/hassio/hassio_addon_testing/'>테스트 </a></li>
          <li><a  href='/hassio/hassio_addon_publishing/'>배포하기 </a></li>
          <li><a  href='/hassio/hassio_addon_presentation/'>홍보하기 </a></li>
          <li><a  href='/hassio/hassio_addon_repository/'>저장소 관리 </a></li>
          <li><a  href='/hassio/hassio_addon_security/'>보안 검수 </a></li>
        </ol>
      </li>
    </ul>
  </div>
</section>

  
</div>

        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright grid">
        <div class='company grid__item one-third lap-one-half palm-one-whole'>
          <div class="title">
            <img src="/images/home-assistant-logo.png" width="36" height="36" alt="Home Assistant"> 홈어시스턴트
          </div>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          <ul>
            <li><a href='https://alerts.home-assistant.io'>Home Assistant Alerts</a></li>
            <li><a href='https://cafe.naver.com/koreassistant'>HA 네이버 카페</a></li>
          </ul>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          이 웹사이트는 <a href='https://jekyllrb.com/'>Jekyll</a>과
          <a href='https://github.com/coogie/oscailte'>Oscalite 테마</a>를 사용합니다.
        </div>
      </div>
    </div>
  </div>
</div>

    </footer>

    <script>
var _gaq=[['_setAccount',''],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script src="/javascripts/prism.js?5d6619066a1fc5cd819a93c132b539ac" type="text/javascript"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript">
docsearch({
  apiKey: 'ae96d94b201c5444c8a443093edf3efb',
  indexName: 'home-assistant',
  inputSelector: '#search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
document.querySelector('.search .close').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'none';
});
document.querySelector('.show-search').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'block';
  document.getElementById('toggle').checked = false;
  document.querySelector('.search-container input').focus();
});
</script>

  </body>
</html>
