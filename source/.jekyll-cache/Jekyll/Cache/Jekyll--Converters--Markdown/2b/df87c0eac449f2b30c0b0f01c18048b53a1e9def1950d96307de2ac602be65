I"£<p>The Multi-factor Authentication (MFA) modules require you to solve a second challenge after you provide your password.</p>
<p>A password can be compromised in a number of ways, for example, it can be guessed if it is a simple password. MFA provides a second level of defense by requiring:</p>
<ul>
<li>something you know, like your username and password, and</li>
<li>something you have, like a one-time password sent to your phone.</li>
</ul>
<p>You can use MFA with any of the other authentication providers. If more than one MFA module is enabled, you can choose one when you log in.</p>
<p>You can turn MFA on and off in the <a href="/docs/authentication/#your-account-profile">profile page</a> for your user account.</p>
<h2>Available MFA modules</h2>
<h3>Time-based One-Time Password MFA module</h3>
<p><a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm">Time-based One-Time Password</a> (TOTP) is widely adopted in modern authentication systems.</p>
<p>Home Assistant generates a secret key which is synchronized with an app on your phone. Every thirty seconds or so the phone app generates a random six digit number. Because Home Assistant knows the secret key, it knows which number will be generated. If you enter the correct digits, then you‚Äôre in.</p>
<h4>Setting up TOTP</h4>
<p>Enable TOTP in your <code>configuration.yaml</code> like this:</p>
<pre><code class="language-yaml">homeassistant:
  auth_mfa_modules:
    - type: totp
</code></pre>
<p>If no <code>auth_mfa_modules</code> config section is defined in <code>configuration.yaml</code> a TOTP module named ‚ÄúAuthenticator app‚Äù will be autoloaded.</p>
<p>You will need an authenticator app on your phone. We recommend either <a href="https://support.google.com/accounts/answer/1066447">Google Authenticator</a> or <a href="https://authy.com/">Authy</a>. Both are available for iOS or Android.</p>
<p>After restarting Home Assistant, go to your <a href="/docs/authentication/#your-account-profile">profile page</a> and there should be a ‚ÄúMulti-factor Authentication Modules‚Äù section.</p>
<p>Click <em>Enable</em> and a new secret key will be generated. Go to your phone app and enter the key, either by scanning the QR code or typing in the key below the QR code manually.</p>
<img src='/images/docs/authentication/mfa.png' alt='Screenshot of setting up multi-factor authentication' style='border: 0;box-shadow: none;'>
<div class='note warning'>
Please treat the secret key like a password - never expose it to others.
</div>
<p>Your phone app will now start generating a different six-digit code every thirty seconds or so. Enter one of these into Home Assistant under the QR code where it asks for a <em>Code</em>. Home Assistant and your phone app are now in sync and you can now use the code displayed in the app to log in.</p>
<h4>Using TOTP</h4>
<p>Once TOTP is enabled, Home Assistant requires the latest code from your phone app before you can log in.</p>
<div class='note'>
<p>TOTP is <em>time based</em> so it relies on your Home Assistant clock being accurate. If the verification keeps failing, make sure the clock on Home Assistant is correct.</p>
</div>
<h3>Notify multi-factor authentication module</h3>
<p>The Notify MFA module uses the <a href="/integrations/notify/">notify component</a> to send you an <a href="https://en.wikipedia.org/wiki/HMAC-based_One-time_Password_algorithm">HMAC-based One-Time Password</a>. It is typically sent to your phone, but can be sent to any destination supported by a <code>notify</code> service. You use this password to log in.</p>
<h4>Setting up TOTP</h4>
<p>Add Notify MFA to your <code>configuration.yaml</code> file like this:</p>
<pre><code class="language-yaml">homeassistant:
  auth_mfa_modules:
    - type: notify
      include:
        - notify_entity
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='exclude' href='#exclude'></a> exclude</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of notifying service entities you want to exclude.</p>
</span></p></dd><dt><a class='title-link' name='include' href='#include'></a> include</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of notifying service entities you want to include.</p>
</span></p></dd><dt><a class='title-link' name='message' href='#message'></a> message</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Optional)</span><span class='description'><p>The message template.</p>
</span></p></dd></dl>
</div>
<pre><code class="language-yaml"># Example configuration, with a message template.
homeassistant:
  auth_mfa_modules:
    - type: totp
      name: Authenticator app
    - type: notify
      message: 'I almost forget, to get into my clubhouse, you need to say {}'
</code></pre>
<p>After restarting Home Assistant, go to your <a href="/docs/authentication/#your-account-profile">profile page</a> and there should be a ‚ÄúMulti-factor Authentication Modules‚Äù section. Click <em>Enable</em> on the <em>Notify One-Time Password</em> option.</p>
<p>Try logging out, then logging in again. You will be asked for the six-digit one-time password that was sent to your notify service. Enter the password to log in.</p>
<p>If the validation failed, a new one-time password will be sent again.</p>
<div class='note'>
<p>The Notify MFA module can‚Äôt tell if the one-time password was delivered successfully. If you don‚Äôt get the notification, you won‚Äôt be able to log in.</p>
<p>You can disable the Notify MFA module by editing or removing the file <code>[your_config_dir]/.storage/auth_module.notify</code>.</p>
</div>
:ET