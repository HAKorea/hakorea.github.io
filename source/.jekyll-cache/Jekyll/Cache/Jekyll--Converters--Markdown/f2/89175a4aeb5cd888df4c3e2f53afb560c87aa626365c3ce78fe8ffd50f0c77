I"¯1<p>The <code>plex</code> integration allows you to connect to a <a href="https://plex.tv">Plex Media Server</a>. Once connected, <a href="https://www.plex.tv/apps-devices/">Plex Clients</a> playing media from the connected Plex Media Server will show up as <a href="/integrations/media_player/">Media Players</a> and report playback status via a <a href="/integrations/sensor/">Sensor</a> in Home Assistant. The Media Players will allow you to control media playback and see the current playing item.</p>
<p>There is currently support for the following device types within Home Assistant:</p>
<ul>
<li><a href="#media-player">Media Player</a></li>
<li><a href="#sensor">Sensor</a></li>
</ul>
<p>If your Plex server has been claimed by a Plex account via the <a href="https://plex.tv/claim">claim interface</a>, Home Assistant will require authentication to connect.</p>
<p>The preferred way to enable the Plex integration is via <strong>Configuration</strong> -&gt; <strong>Integrations</strong>. You will be redirected to the <a href="https://plex.tv">plex.tv</a> website to sign in with your Plex account. Once access is granted, Home Assistant will connect to the server linked to the associated account. If multiple Plex servers are available on the account, you will be prompted to complete the configuration by selecting the desired server on the Integrations page. Home Assistant will show as an authorized device on the <a href="https://app.plex.tv/web/app">Plex Web</a> interface under <strong>Settings</strong> -&gt; <strong>Authorized Devices</strong>.</p>
<div class='note info'>
<p>Local and secure connections are preferred when setting up an Integration. After the initial configuration, all connections to your Plex servers are made directly without connecting to Plex‚Äôs services.</p>
</div>
<p>If <a href="/integrations/discovery/">discovery</a> is enabled and a local Plex server is found, a legacy <code>media_player</code> configuration (i.e., a <code>plex.conf</code> file) will be imported. GDM can be enabled via the Plex Web App under <strong>Settings</strong> -&gt; <strong>(Server Name)</strong> -&gt; <strong>Settings</strong> -&gt; <strong>Network</strong> and choosing <strong>Enable local network discovery (GDM)</strong>.</p>
<p>The <code>plex</code> integration can also be configured via <code>configuration.yaml</code>:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
plex:
  token: MYSECRETTOKEN
</code></pre>
<div class='note warning'>
<p>Only one Plex server can be configured when using <code>configuration.yaml</code>. To add more servers, set up via <strong>Configuration</strong> -&gt; <strong>Integrations</strong>.</p>
</div>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='host' href='#host'></a> host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The IP address or hostname of your Plex server.</p>
</span></p></dd><dt><a class='title-link' name='port' href='#port'></a> port</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The port of your Plex Server.</p>
</span></p><p class='default'>
Default value: <p>32400</p>
</p></dd><dt><a class='title-link' name='token' href='#token'></a> token</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>A valid X-Plex-Token for your Plex server. If provided without <code>host</code> and <code>port</code>, a connection URL will be retreived from Plex.</p>
</span></p></dd><dt><a class='title-link' name='server' href='#server'></a> server</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Name of Plex server to use if multiple servers are associated with the token‚Äôs Plex account. Only used if <code>token</code> is provided without <code>host</code> and <code>port</code>.</p>
</span></p></dd><dt><a class='title-link' name='ssl' href='#ssl'></a> ssl</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Use HTTPS to connect to Plex server, <strong>NOTE:</strong> host <strong>must not</strong> be an IP when this option is enabled.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='verify_ssl' href='#verify_ssl'></a> verify_ssl</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Verify the SSL certificate of your Plex server. You may need to disable this check if your local server enforces secure connections with the default certificate.</p>
</span></p><p class='default'>
Default value: <p>true</p>
</p></dd><dt><a class='title-link' name='media_player' href='#media_player'></a> media_player</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Options to set the default behavior of <code>media_player</code> entities for new Integrations. <strong>NOTE:</strong> These options are exposed as Configuration Options (<strong>Integrations</strong> -&gt; <strong>Configured</strong> ‚Äì&gt; <strong>Plex</strong> ‚Äì&gt; <strong>Gear Icon</strong>). Configuration Options will take precedence.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='show_all_controls' href='#show_all_controls'></a> show_all_controls</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Forces all controls to display. Ignores dynamic controls (ex. show volume controls for client A but not for client B) based on detected client capabilities. This option allows you to override this detection if you suspect it to be incorrect.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='use_episode_art' href='#use_episode_art'></a> use_episode_art</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Display TV episode art instead of TV show art.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd></dl></dd></dl>
</div>
<pre><code class="language-yaml"># Complete configuration.yaml entry
plex:
  host: 192.168.1.100
  port: 32400
  token: MY_SECRET_TOKEN
  ssl: true
  verify_ssl: true
  media_player:
    use_episode_art: true
    show_all_controls: false
</code></pre>
<h2>Media Player</h2>
<p>The <code>plex</code> media_player platform will create Media Player entities for each connected client device. These entities will display media information, playback progress, and playback controls if supported by the device.</p>
<h3>Service <code>play_media</code></h3>
<p>Plays a song, playlist, TV episode, or video on a connected client.</p>
<h4>Music</h4>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td><code>entity_id</code> of the client</td>
<td>media_player.theater_plex</td>
</tr>
<tr>
<td><code>media_content_id</code></td>
<td>no</td>
<td>Quote escaped JSON with <code>library_name</code>, <code>artist_name</code>, <code>album_name</code>, <code>track_name</code>, <code>shuffle</code> (0 or 1).</td>
<td>{ \‚Äúlibrary_name\‚Äù : \‚ÄúMy Music\‚Äù, \‚Äúartist_name\‚Äù : \‚ÄúAdele\‚Äù, \‚Äúalbum_name\‚Äù : \‚Äú25\‚Äù, \‚Äútrack_name\‚Äù : \‚Äúhello\‚Äù, \‚Äúshuffle\‚Äù: \‚Äú0\‚Äù }</td>
</tr>
<tr>
<td><code>media_content_type</code></td>
<td>no</td>
<td>Type of media to play, in this case <code>MUSIC</code></td>
<td>MUSIC</td>
</tr>
</tbody>
</table>
<h4>Playlist</h4>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td><code>entity_id</code> of the client</td>
<td>media_player.theater_plex</td>
</tr>
<tr>
<td><code>media_content_id</code></td>
<td>no</td>
<td>Quote escaped JSON with <code>playlist_name</code>, <code>shuffle</code> (0 or 1).</td>
<td>{ \‚Äúplaylist_name\‚Äù : \‚ÄúThe Best of Disco\‚Äù \‚Äúshuffle\‚Äù: \‚Äú0\‚Äù }</td>
</tr>
<tr>
<td><code>media_content_type</code></td>
<td>no</td>
<td>Type of media to play, in this case <code>PLAYLIST</code></td>
<td>PLAYLIST</td>
</tr>
</tbody>
</table>
<h4>TV Episode</h4>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td><code>entity_id</code> of the client</td>
<td>media_player.theater_plex</td>
</tr>
<tr>
<td><code>media_content_id</code></td>
<td>no</td>
<td>Quote escaped JSON with <code>library_name</code>, <code>show_name</code>, <code>season_number</code>, <code>episode_number</code>, <code>shuffle</code> (0 or 1).</td>
<td>{ \‚Äúlibrary_name\‚Äù : \‚ÄúAdult TV\‚Äù, \‚Äúshow_name\‚Äù : \‚ÄúRick and Morty\‚Äù, \‚Äúseason_number\‚Äù : 2, \‚Äúepisode_number\‚Äù : 5, \‚Äúshuffle\‚Äù: \‚Äú0\‚Äù }</td>
</tr>
<tr>
<td><code>media_content_type</code></td>
<td>no</td>
<td>Type of media to play, in this case <code>EPISODE</code></td>
<td>EPISODE</td>
</tr>
</tbody>
</table>
<h4>Video</h4>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td><code>entity_id</code> of the client</td>
<td>media_player.theater_plex</td>
</tr>
<tr>
<td><code>media_content_id</code></td>
<td>no</td>
<td>Quote escaped JSON with <code>library_name</code>, <code>video_name</code>, <code>shuffle</code> (0 or 1).</td>
<td>{ \‚Äúlibrary_name\‚Äù : \‚ÄúAdult Movies\‚Äù, \‚Äúvideo_name\‚Äù : \‚ÄúBlade\‚Äù, \‚Äúshuffle\‚Äù: \‚Äú0\‚Äù }</td>
</tr>
<tr>
<td><code>media_content_type</code></td>
<td>no</td>
<td>Type of media to play, in this case <code>VIDEO</code></td>
<td>VIDEO</td>
</tr>
</tbody>
</table>
<h3>Compatibility</h3>
<table>
<thead>
<tr>
<th>Client</th>
<th>Limitations</th>
</tr>
</thead>
<tbody>
<tr>
<td>Any (when all controls disabled)</td>
<td>A stop button will appear but is not functional.</td>
</tr>
<tr>
<td>Any (when casting)</td>
<td>Controlling playback will work but with error logging.</td>
</tr>
<tr>
<td>Any (remote client)</td>
<td>Controls disabled.</td>
</tr>
<tr>
<td>Apple TV (PlexConnect)</td>
<td>Controls disabled.  Music does not work.</td>
</tr>
<tr>
<td>iOS</td>
<td>None</td>
</tr>
<tr>
<td>NVidia Shield</td>
<td>Mute disabled. Volume set below 2 will cause error logging. Controlling playback when the Shield is both a client and a server will work but with error logging</td>
</tr>
<tr>
<td>Plex Web</td>
<td>None</td>
</tr>
<tr>
<td>Tivo Plex App</td>
<td>Only play, pause, stop/off controls enabled</td>
</tr>
</tbody>
</table>
<h3>Notes</h3>
<ul>
<li>
<p>The <code>plex</code> integration supports multiple Plex servers. Additional connections can be configured under Configuration &gt; Integrations.</p>
</li>
<li>
<p>When setting up a server via <code>configuration.yaml</code>, it is possible to get errors that look like the following.</p>
<pre><code class="language-txt">ERROR:plexapi:http://192.168.1.10:32400: ('Connection aborted.', BadStatusLine(&quot;''&quot;,))
INFO:homeassistant.components.media_player.plex:No server found at: http://192.168.1.10:32400
</code></pre>
<p>If this occurs, check the setting <code>Server</code>&gt;<code>Network</code>&gt;<code>Secure connections</code> on your Plex Media Server: if it is set to <code>Preferred</code> or <code>Required</code>, you may need to manually set the <code>ssl</code> and <code>verify_ssl</code> configuration options to, respectively, <code>true</code> and <code>false</code>.</p>
</li>
<li>
<p>Movies must be located under ‚ÄòMovies‚Äô section in the Plex library to properly get ‚Äòplaying‚Äô state.</p>
</li>
</ul>
<h2>Sensor</h2>
<p>The <code>plex</code> sensor platform will monitor activity on a given <a href="https://plex.tv/">Plex Media Server</a>. It will create a sensor that shows the number of currently watching users as the state. If you click the sensor for more details, it will show you who is watching what.</p>
:ET