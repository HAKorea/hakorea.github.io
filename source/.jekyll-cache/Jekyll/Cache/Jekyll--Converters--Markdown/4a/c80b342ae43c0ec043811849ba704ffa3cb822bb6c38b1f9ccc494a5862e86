I"%<p>This platform allows you to connect to your <a href="https://todoist.com">Todoist Projects</a> and generate binary sensors. A different sensor will be created for each individual project, or you can specify “custom” projects which match against criteria you set (more on that below). These sensors will be <code>on</code> if you have a task due in that project or <code>off</code> if all the tasks in the project are completed or if the project doesn’t have any tasks at all. All tasks get updated roughly every 15 minutes.</p>
<h3>Prerequisites</h3>
<p>You need to determine your Todoist API token. This is fairly simple to do; just go <a href="https://todoist.com/Users/viewPrefs?page=authorizations">to the Integrations section on your Todoist settings page</a> and find the section labeled “API token” at the bottom of the page. Copy that token and use it in your configuration file.</p>
<h3>Basic Setup</h3>
<p>To integrate Todoist in Home Assistant, add the following section to your <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
calendar:
  - platform: todoist
    token: YOUR_API_TOKEN
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='token' href='#token'></a> token</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>The API token used to authorize Home Assistant to access your projects. Above you have more info about it.</p>
</span></p></dd><dt><a class='title-link' name='custom_projects' href='#custom_projects'></a> custom_projects</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Details on any “custom” binary sensor projects you want to create.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='name' href='#name'></a> name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>The name of your custom project. Only required if you specify that you want to create a custom project.</p>
</span></p></dd><dt><a class='title-link' name='due_date_days' href='#due_date_days'></a> due_date_days</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Only include tasks due within this many days. If you don’t have any tasks with a due date set, this returns nothing.</p>
</span></p></dd><dt><a class='title-link' name='include_projects' href='#include_projects'></a> include_projects</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Only include tasks in these projects. Tasks in all other projects will be ignored.</p>
</span></p></dd><dt><a class='title-link' name='labels' href='#labels'></a> labels</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Only include tasks with at least one of these labels (i.e., this works as an <code>or</code> statement).</p>
</span></p></dd></dl></dd></dl>
</div>
<h3>Custom Projects</h3>
<p>Creating custom projects is super-easy and quite powerful. All you need to run the basic Todoist projects is your API token, but if you wanted, you could go even deeper. Here’s an example:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
calendar:
  - platform: todoist
    token: YOUR_API_TOKEN
    custom_projects:
      - name: 'All Projects'
      - name: 'Due Today'
        due_date_days: 0
      - name: 'Due This Week'
        due_date_days: 7
      - name: 'Math Homework'
        labels:
          - Homework
        include_projects:
          - Mathematical Structures II
          - Calculus II
</code></pre>
<p>(See <a href="/docs/configuration/secrets/">here</a> for more details about what that <code>!secret</code> does – it’s not exclusive to Todoist, and can help keep your API keys and passwords a little safer!)</p>
<p>As you can see, there are 4 custom projects here:</p>
<ul>
<li>
<p>A project containing <em>all</em> of the tasks on this account.</p>
</li>
<li>
<p>A project containing <em>all</em> the tasks on this account that are due today.</p>
</li>
<li>
<p>A project containing <em>all</em> the tasks on this account due within the next week.</p>
</li>
<li>
<p>A project containing everything with the label “Homework”, taking only 2 projects into account.</p>
</li>
</ul>
<p>You can mix-and-match these attributes to create all sorts of custom projects. You can even use <a href="https://ifttt.com/todoist">IFTTT</a> to create a task with a certain label, then have Home Assistant do some kind of automation when a task with that label comes due.</p>
<p>Home Assistant does its best to <a href="https://github.com/home-assistant/home-assistant/blob/master/homeassistant/components/todoist/calendar.py">determine what task in each project is “most” important</a>, and it’s that task which has its state reported. You can access the other tasks you have due soon via the <code>all_tasks</code> array (see below).</p>
<h3>Sensor attributes</h3>
<ul>
<li>
<p><strong>offset_reached</strong>: Not used.</p>
</li>
<li>
<p><strong>all_day</strong>: <code>True</code> if the reported task doesn’t have a due date. <code>False</code> if there is a due date set.</p>
</li>
<li>
<p><strong>message</strong>: The title of the “most important” task coming up in this project.</p>
</li>
<li>
<p><strong>description</strong>: A URL pointing to the task on the Todoist website.</p>
</li>
<li>
<p><strong>location</strong>: Not used.</p>
</li>
<li>
<p><strong>start_time</strong>: The last time the Todoist integration got updated. Usually within the last 15 minutes.</p>
</li>
<li>
<p><strong>end_time</strong>: When the task is due.</p>
</li>
<li>
<p><strong>all_tasks</strong>: A list of all tasks in this project, sorted from most important to least important.</p>
</li>
<li>
<p><strong>priority</strong>: The priority Todoist reports this task as having. 1 means lowest priority, 4 means highest. Note that this is the <strong>opposite</strong> of how things are displayed in the Todoist app!</p>
</li>
<li>
<p><strong>task_comments</strong>: Any comments added to this task.</p>
</li>
<li>
<p><strong>task_labels</strong>: All labels associated with this task.</p>
</li>
<li>
<p><strong>overdue</strong>: Whether the reported task is past its due date.</p>
</li>
<li>
<p><strong>due_today</strong>: Whether the reported task is due today.</p>
</li>
</ul>
<h3>Services</h3>
<p>Todoist also comes with access to a service, <code>todoist.new_task</code>. This service can be used to create a new Todoist task. You can specify labels and a project, or you can leave them blank, and the task will go to your “Inbox” project.</p>
<p>Here are two example JSON payloads resulting in the same task:</p>
<pre><code class="language-json">{
    &quot;content&quot;: &quot;Pick up the mail&quot;,
    &quot;project&quot;: &quot;Errands&quot;,
    &quot;labels&quot;:&quot;Homework,School&quot;,
    &quot;priority&quot;:3,
    &quot;due_date&quot;:&quot;2017-09-12 14:00&quot;
}
</code></pre>
<pre><code class="language-json">{
    &quot;content&quot;: &quot;Pick up the mail&quot;,
    &quot;project&quot;: &quot;Errands&quot;,
    &quot;labels&quot;:&quot;Homework,School&quot;,
    &quot;priority&quot;:3,
    &quot;due_date_string&quot;:&quot;tomorrow at 14:00&quot;,
    &quot;due_date_lang&quot;:&quot;en&quot;
}
</code></pre>
<ul>
<li>
<p><strong>content</strong> (<em>Required</em>): The name of the task you want to create.</p>
</li>
<li>
<p><strong>project</strong> (<em>Optional</em>): The project to put the task in.</p>
</li>
<li>
<p><strong>labels</strong> (<em>Optional</em>): Any labels you want to add to the task, separated by commas.</p>
</li>
<li>
<p><strong>priority</strong> (<em>Optional</em>): The priority of the task, from 1-4. Again, 1 means least important, and 4 means most important.</p>
</li>
<li>
<p><strong>due_date_string</strong> (<em>Optional</em>): When the task should be due, in <a href="https://support.todoist.com/hc/en-us/articles/205325931-Dates-and-Times">natural language</a>. Mutually exclusive with <code>due_date</code></p>
</li>
<li>
<p><strong>due_date_lang</strong> (<em>Optional</em>): When <code>due_date_string</code> is set, it is possible to set the language.
Valid languages are: <code>en</code>, <code>da</code>, <code>pl</code>, <code>zh</code>, <code>ko</code>, <code>de</code>, <code>pt</code>, <code>ja</code>, <code>it</code>, <code>fr</code>, <code>sv</code>, <code>ru</code>, <code>es</code>, <code>nl</code></p>
</li>
<li>
<p><strong>due_date</strong> (<em>Optional</em>): When the task should be due, in either YYYY-MM-DD format or YYYY-MM-DD HH:MM format. Mutually exclusive with <code>due_date_string</code>.</p>
</li>
</ul>
<p>Note that there’s (currently) no way to mark tasks as done through Home Assistant; task names do not necessarily have to be unique, so you could find yourself in a situation where you close the wrong task.</p>
:ET