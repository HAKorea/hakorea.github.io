I"™<p>The <code>prometheus</code> integration exposes metrics in a format which <a href="https://prometheus.io/">Prometheus</a> can read.</p>
<h2>Configuration</h2>
<p>To use the <code>prometheus</code> integration in your installation, add the following to your <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
prometheus:
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='namespace' href='#namespace'></a> namespace</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The ‚Äúnamespace‚Äù that will be assigned to all the Prometheus metrics. This is the prefix of the metric name. E.g., having <code>myhass</code> as the namespace will cause the device tracker metrics to be <code>myhass_device_tracker_state</code>, the switch metrics to be <code>myhass_switch_state</code> and so on. The default is to not add any prefix to the metrics name. (available in version 0.73.0 and later)</p>
</span></p></dd><dt><a class='title-link' name='filter' href='#filter'></a> filter</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Filtering directives for the integrations which should be included or excluded from recording.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='exclude_entities' href='#exclude_entities'></a> exclude_entities</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of entity ids to be excluded from recording.</p>
</span></p></dd><dt><a class='title-link' name='exclude_domains' href='#exclude_domains'></a> exclude_domains</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of domains to be excluded from recording.</p>
</span></p></dd><dt><a class='title-link' name='include_entities' href='#include_entities'></a> include_entities</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of entity ids to be included from recordings. If set, all other entities will not be recorded. Values set by the <strong>exclude_</strong>* option will prevail.</p>
</span></p></dd><dt><a class='title-link' name='include_domains' href='#include_domains'></a> include_domains</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The list of domains to be included from recordings. If set, all other entities will not be recorded. Values set by the <strong>exclude_</strong>* option will prevail.</p>
</span></p></dd></dl></dd><dt><a class='title-link' name='default_metric' href='#default_metric'></a> default_metric</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Metric name to use when an entity doesn‚Äôt have a unit.</p>
</span></p><p class='default'>
Default value: <p>uses the entity id of the entity</p>
</p></dd><dt><a class='title-link' name='override_metric' href='#override_metric'></a> override_metric</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Metric name to use instead of unit or default metric. This will store all data points in a single metric.</p>
</span></p></dd><dt><a class='title-link' name='component_config' href='#component_config'></a> component_config</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>This attribute contains component-specific override values. See <a href="/getting-started/customizing-devices/">Customizing devices and services</a> for format.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='override_metric' href='#override_metric'></a> override_metric</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Metric name to use instead of unit or default metric. This will store all data points in a single metric.</p>
</span></p></dd></dl></dd><dt><a class='title-link' name='component_config_domain' href='#component_config_domain'></a> component_config_domain</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>This attribute contains domain-specific component override values. See <a href="/getting-started/customizing-devices/">Customizing devices and services</a> for format.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='override_metric' href='#override_metric'></a> override_metric</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Metric name to use instead of unit or default metric. This will store all data points in a single metric.</p>
</span></p></dd></dl></dd><dt><a class='title-link' name='component_config_glob' href='#component_config_glob'></a> component_config_glob</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>This attribute contains component-specific override values. See <a href="/getting-started/customizing-devices/">Customizing devices and services</a> for format.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='override_metric' href='#override_metric'></a> override_metric</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Metric name to use instead of unit or default metric. This will store all data points in a single metric.</p>
</span></p></dd></dl></dd></dl>
</div>
<h2>Full Example</h2>
<p>Advanced configuration example:</p>
<pre><code class="language-yaml"># Advanced configuration.yaml entry
prometheus:
  namespace: hass
  component_config_glob:
    sensor.*_hum:
      override_metric: humidity_percent
    sensor.*_temp:
      override_metric: temperature_c
    sensor.temperature*:
      override_metric: temperature_c
    sensor.*_bat:
      override_metric: battery_percent
  filter:
    include_domains:
      - sensor
</code></pre>
<p>You can then configure Prometheus to fetch metrics from Home Assistant by adding to its <code>scrape_configs</code> configuration.</p>
<pre><code class="language-yaml"># Example Prometheus scrape_configs entry
  - job_name: 'hass'
    scrape_interval: 60s
    metrics_path: /api/prometheus

    # Legacy api password
    params:
      api_password: ['PASSWORD']

    # Long-Lived Access Token
    bearer_token: 'your.longlived.token'

    scheme: https
    static_configs:
      - targets: ['HOSTNAME:8123']
</code></pre>
<p>When looking into the metrics on the Prometheus side, there will be:</p>
<ul>
<li>All Home Assistant domains, which can be easily found through the common <strong>namespace</strong> prefix, if defined.</li>
<li>The <a href="https://github.com/prometheus/client_python">client library</a> provided metrics, which are a bunch of <strong>process_*</strong> and also a single pseudo-metric <strong>python_info</strong> which contains (not as value but as labels) information about the Python version of the client, i.e., the Home Assistant Python interpreter.</li>
</ul>
<p>Typically, you will only be interested in the first set of metrics.</p>
:ET