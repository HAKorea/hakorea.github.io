I"Ÿ1<p>The <code>template</code> platform supports binary sensors which get their values from
other entities. The state of a Template Binary Sensor can only be <code>on</code> or
<code>off</code>.</p>
<h2>Configuration</h2>
<p>Here is an example of adding a Template Binary Sensor to the <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
binary_sensor:
  - platform: template
    sensors:
      sun_up:
        friendly_name: &quot;Sun is up&quot;
        value_template: &gt;-
          {{ state_attr('sun.sun', 'elevation')|float &gt; 0 }}
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='sensors' href='#sensors'></a> sensors</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Required)</span><span class='description'><p>List of your sensors.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='sensor_name' href='#sensor_name'></a> sensor_name</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Required)</span><span class='description'><p>The slug of the sensor.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='friendly_name' href='#friendly_name'></a> friendly_name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Name to use in the frontend.</p>
</span></p></dd><dt><a class='title-link' name='entity_id' href='#entity_id'></a> entity_id</dt><dd><p class='desc'><span class='type'>(<span class='string list'>string | list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>A list of entity IDs so the sensor only reacts to state changes of these entities. This can be used if the automatic analysis fails to find all relevant entities.</p>
</span></p></dd><dt><a class='title-link' name='device_class' href='#device_class'></a> device_class</dt><dd><p class='desc'><span class='type'>(<span class='device_class'><a href="/docs/configuration/customizing-devices/#device-class">device_class</a></span>)</span><span class='required'>(Optional)</span><span class='description'><p>Sets the <a href="/integrations/binary_sensor/">class of the device</a>, changing the device state and icon that is displayed on the frontend.</p>
</span></p><p class='default'>
Default value: <p>None</p>
</p></dd><dt><a class='title-link' name='value_template' href='#value_template'></a> value_template</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Required)</span><span class='description'><p>The sensor is <code>on</code> if the template evaluates as <code>True</code> and <code>off</code> otherwise. The actual appearance in the frontend (<code>Open</code>/<code>Closed</code>, <code>Detected</code>/<code>Clear</code> etc) depends on the sensor‚Äôs device_class value</p>
</span></p></dd><dt><a class='title-link' name='availability_template' href='#availability_template'></a> availability_template</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Optional)</span><span class='description'><p>Defines a template to get the <code>available</code> state of the component. If the template returns <code>true</code>, the device is <code>available</code>. If the template returns any other value, the device will be <code>unavailable</code>. If <code>availability_template</code> is not configured, the component will always be <code>available</code>.</p>
</span></p><p class='default'>
Default value: <p>true</p>
</p></dd><dt><a class='title-link' name='icon_template' href='#icon_template'></a> icon_template</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Optional)</span><span class='description'><p>Defines a template for the icon of the sensor.</p>
</span></p></dd><dt><a class='title-link' name='entity_picture_template' href='#entity_picture_template'></a> entity_picture_template</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Optional)</span><span class='description'><p>Defines a template for the entity picture of the sensor.</p>
</span></p></dd><dt><a class='title-link' name='attribute_templates' href='#attribute_templates'></a> attribute_templates</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Defines templates for attributes of the sensor.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='attribute-template' href='#attribute-template'></a> attribute: template</dt><dd><p class='desc'><span class='type'>(<span class='template'><a href="/docs/configuration/templating/">template</a></span>)</span><span class='required'>(Required)</span><span class='description'><p>The attribute and corresponding template.</p>
</span></p></dd></dl></dd><dt><a class='title-link' name='delay_on' href='#delay_on'></a> delay_on</dt><dd><p class='desc'><span class='type'>(<span class='time'>time</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The amount of time the template state must be <em><strong>met</strong></em> before this sensor will switch to <code>on</code>.</p>
</span></p></dd><dt><a class='title-link' name='delay_off' href='#delay_off'></a> delay_off</dt><dd><p class='desc'><span class='type'>(<span class='time'>time</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The amount of time the template state must be <em><strong>not met</strong></em> before this sensor will switch to <code>off</code>.</p>
</span></p></dd></dl></dd></dl></dd></dl>
</div>
<h2>Considerations</h2>
<h3>Startup</h3>
<p>If you are using the state of a platform that takes extra time to load, the
Template Binary Sensor may get an <code>unknown</code> state during startup. This results
in error messages in your log file until that platform has completed loading.
If you use <code>is_state()</code> function in your template, you can avoid this situation.
For example, you would replace
<code>{{ states.switch.source.state == 'on' }}</code>
with this equivalent that returns <code>true</code>/<code>false</code> and never gives an unknown
result:
<code>{{ is_state('switch.source', 'on') }}</code></p>
<h3>Entity IDs</h3>
<p>The template engine will attempt to work out what entities should trigger an
update of the sensor. This can fail, for example if your template loops over
the contents of a group. In this case you can use <code>entity_id</code> to provide a
list of entity IDs that will cause the sensor to update or you can run the
service <code>homeassistant.update_entity</code> to update the sensor at will.</p>
<h2>Examples</h2>
<p>In this section you find some real-life examples of how to use this sensor.</p>
<h3>Sensor Threshold</h3>
<p>This example indicates true if a sensor is above a given threshold. Assuming a
sensor of <code>furnace</code> that provides a current reading for the fan motor, we can
determine if the furnace is running by checking that it is over some threshold:</p>
<pre><code class="language-yaml">binary_sensor:
  - platform: template
    sensors:
      furnace_on:
        friendly_name: &quot;Furnace Running&quot;
        device_class: heat
        value_template: &quot;{{ states('sensor.furnace')|float &gt; 2.5 }}&quot;
</code></pre>
<h3>Switch as Sensor</h3>
<p>Some movement sensors and door/window sensors will appear as a switch. By using
a Template Binary Sensor, the switch can be displayed as a binary sensors. The
original switch can then be hidden by
<a href="/getting-started/customizing-devices/">customizing</a>.</p>
<pre><code class="language-yaml">binary_sensor:
  - platform: template
    sensors:
      movement:
        device_class: motion
        value_template: &quot;{{ is_state('switch.movement', 'on') }}&quot;
      door:
        device_class: opening
        value_template: &quot;{{ is_state('switch.door', 'on') }}&quot;
</code></pre>
<h3>Combining Multiple Sensors</h3>
<p>This example combines multiple CO sensors into a single overall
status. When using templates with binary sensors, you need to return
<code>true</code> or <code>false</code> explicitly.</p>
<pre><code class="language-yaml">binary_sensor:
  - platform: template
    sensors:
      co:
        friendly_name: &quot;CO&quot;
        device_class: gas
        value_template: &gt;-
          {{ is_state('sensor.bedroom_co_status', 'Ok')
             and is_state('sensor.kitchen_co_status', 'Ok')
             and is_state('sensor.wardrobe_co_status', 'Ok') }}
</code></pre>
<h3>Washing Machine Running</h3>
<p>This example creates a washing machine ‚Äúload running‚Äù sensor by monitoring an
energy meter connected to the washer. During the washer‚Äôs operation, the energy
meter will fluctuate wildly, hitting zero frequently even before the load is
finished. By utilizing <code>delay_off</code>, we can have this sensor only turn off if
there has been no washer activity for 5 minutes.</p>
<pre><code class="language-yaml"># Determine when the washing machine has a load running.
binary_sensor:
  - platform: template
    sensors:
      washing_machine:
        friendly_name: &quot;Washing Machine&quot;
        delay_off:
          minutes: 5
        value_template: &gt;-
          {{ states('sensor.washing_machine_power')|float &gt; 0 }}
</code></pre>
<h3>Is Anyone Home</h3>
<p>This example is determining if anyone is home based on the combination of device
tracking and motion sensors. It‚Äôs extremely useful if you have kids/baby sitter/
grand parents who might still be in your house that aren‚Äôt represented by a
trackable device in Home Assistant. This is providing a composite of WiFi based
device tracking and Z-Wave multisensor presence sensors.</p>
<pre><code class="language-yaml">binary_sensor:
  - platform: template
    sensors:
      people_home:
        value_template: &gt;-
          {{ is_state('device_tracker.sean', 'home')
             or is_state('device_tracker.susan', 'home')
             or is_state('binary_sensor.office_124', 'on')
             or is_state('binary_sensor.hallway_134', 'on')
             or is_state('binary_sensor.living_room_139', 'on')
             or is_state('binary_sensor.porch_ms6_1_129', 'on')
             or is_state('binary_sensor.family_room_144', 'on') }}
</code></pre>
<h3>Device Tracker sensor with Latitude and Longitude Attributes</h3>
<p>This example shows how to combine a non-GPS (e.g. NMAP) and GPS device tracker while still including latitude and longitude attributes</p>
<pre><code class="language-yaml">binary_sensor:
  - platform: template
    sensors:
      my_device:
        value_template: &gt;-
          {{ is_state('device_tracker.my_device_nmap','home') or is_state('device_tracker.my_device_gps','home') }}
        device_class: 'presence'
        attribute_templates:
          latitude: &gt;-
            {% if is_state('device_tracker.my_device_nmap','home') %}
              {{ state_attr('zone.home','latitude') }}
            {% else %}
              {{ state_attr('device_tracker.my_device_gps','latitude') }}
            {% endif %}
          longitude: &gt;-
            {% if is_state('device_tracker.my_device_nmap','home') %}
              {{ state_attr('zone.home','longitude') }}
            {% else %}
              {{ state_attr('device_tracker.my_device_gps','longitude') }}
            {% endif %}
</code></pre>
<h3>Change the icon when state changes</h3>
<p>This example demonstrates how to use <code>icon_template</code> to change the entity‚Äôs
icon as its state changes, it evaluates the state of its own sensor and uses a
conditional statement to output the appropriate icon.</p>
<pre><code class="language-yaml">sun:
binary_sensor:
  - platform: template
    sensors:
      sun_up:
        entity_id:
          - sun.sun
        value_template: &gt;-
          {{ is_state(&quot;sun.sun&quot;, &quot;above_horizon&quot;) }}
        icon_template: &gt;-
          {% if is_state(&quot;binary_sensor.sun_up&quot;, &quot;on&quot;) %}
            mdi:weather-sunset-up
          {% else %}
            mdi:weather-sunset-down
          {% endif %}
</code></pre>
:ET