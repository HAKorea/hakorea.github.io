I"¶<p><a href="https://unifi-sdn.ubnt.com/">UniFi</a> by <a href="https://www.ubnt.com/">Ubiquiti Networks, inc.</a> is a software that binds gateways, switches and wireless access points together with one graphical front end.</p>
<p>There is currently support for the following device types within Home Assistant:</p>
<ul>
<li><a href="#presence-detection">Presence Detection</a></li>
<li><a href="#switch">Switch</a></li>
</ul>
<h2>Configuration</h2>
<p>Home Assistant offers UniFi integration through <strong>Configuration</strong> -&gt; <strong>Integrations</strong> -&gt; <strong>UniFi Controller</strong>.</p>
<p>Enter <code>host address</code>, <code>user name</code> and <code>password</code> and then continue to select which <code>site</code> you want to connect to Home Assistant. The user needs administrator privileges in order to control POE switches.</p>
<h3>Extra configuration for device tracker</h3>
<p>You can augment the behavior of UniFi device tracker by adding</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
unifi:
  controllers:
    - host: unifi
      site: My site
      ssid_filter:
        - 'HomeSSID'
        - 'IoTSSID'
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='host' href='#host'></a> host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Same address as relevant config entry, needed to identify config entry.</p>
</span></p><p class='default'>
Default value: <p>None</p>
</p></dd><dt><a class='title-link' name='site' href='#site'></a> site</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Same site as relevant config entry, needed to identify config entry.</p>
</span></p><p class='default'>
Default value: <p>None</p>
</p></dd><dt><a class='title-link' name='block_client' href='#block_client'></a> block_client</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>A list of Clients MAC Addresses that can be blocked from the network.</p>
</span></p><p class='default'>
Default value: <p>None</p>
</p></dd><dt><a class='title-link' name='detection_time' href='#detection_time'></a> detection_time</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>How long since the last seen time before the device is marked away, specified in seconds.</p>
</span></p><p class='default'>
Default value: <p>300</p>
</p></dd><dt><a class='title-link' name='dont_track_clients' href='#dont_track_clients'></a> dont_track_clients</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>enable to not allow device tracker to track clients.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='dont_track_devices' href='#dont_track_devices'></a> dont_track_devices</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>enable to not allow device tracker to track devices.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='dont_track_wired_clients' href='#dont_track_wired_clients'></a> dont_track_wired_clients</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>enable to not allow device tracker to track wired clients.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='ssid_filter' href='#ssid_filter'></a> ssid_filter</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Filter the SSIDs that tracking will occur on.</p>
</span></p><p class='default'>
Default value: <p>None</p>
</p></dd></dl>
</div>
<h3>Configuring Users</h3>
<p>The UniFi controller allows you to create multiple users on it besides the main administrator. If all you want to use is the device tracker then it is recommended that you create a limited user that has <code>read-only</code> permissions for the Unifi device tracker. If you want blocking of network access or POE control as well you would need to have â€˜adminâ€™ permissions.</p>
<h3>Conflicts with MQTT</h3>
<p>The Unifi controller can either be a dedicated hardware device (UniFiâ€™s cloud key), or as software any Linux system. If you run the Unifi controller on the same operating system as Home Assistant there may be conflicts in ports if you have the MQTT integration as well.</p>
<p>It is recommended that you run the Unifi controller in a dedicated virtual machine to avoid that situation.</p>
<h2>Presence detection</h2>
<p>This platform allows you to detect presence by looking at devices connected to a <a href="https://ubnt.com/">Ubiquiti</a> <a href="https://www.ubnt.com/enterprise/#unifi">UniFi</a> controller.</p>
<h3>Troubleshooting and Time Synchronization</h3>
<p>Presence detection depends on accurate time configuration between Home Assistant and the UniFi controller.</p>
<p>If Home Assistant and the UniFi controller are running on separate machines or VMs ensure that all clocks are synchronized. Failing to have synchronized clocks will lead to Home Assistant failing to mark a device as home.</p>
<p><a href="https://github.com/home-assistant/home-assistant/issues/10507">Related Issue</a></p>
<h2>Switch</h2>
<h3>Block network access for clients</h3>
<p>Allow control of network access to clients configured in the <code>configuration.yaml</code> file by adding a list of the MAC addresses. Items in this list will have a Home Assistant switch created, using the Unifi Device name, allowing for blocking and unblocking.</p>
<h3>Control clients powered by POE</h3>
<p>Entities appear automatically for each connected POE client. If no POE client device is in operation, no entity will be visible. Note: Unifi infrastructure devices such as access points and other switches are not (yet) supported, even if they are powered over ethernet themselves.</p>
<p>Note that POE control actually configures the network port of the switch which the client is connected to.</p>
<h2>Debugging integration</h2>
<p>If you have problems with UniFi or the integration you can add debug prints to the log.</p>
<pre><code class="language-yaml">logger:
  default: info
  logs:
    aiounifi: debug
    homeassistant.components.unifi: debug
    homeassistant.components.device_tracker.unifi: debug
    homeassistant.components.switch.unifi: debug
</code></pre>
:ET