I"Ö<p>There is currently support for the following device types within Home Assistant:</p>
<ul>
<li><a href="#remote">Remote</a></li>
<li><a href="#sensor">Sensor</a></li>
<li><a href="#switch">Switch</a></li>
</ul>
<h2>Remote</h2>
<p>The <code>broadlink</code> remote platform allows you to interact with Broadlink remote control devices.</p>
<h3>Configuration</h3>
<p>To enable it, add the following lines to your <code>configuration.yaml</code>:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
remote:
  - platform: broadlink
    host: IP_ADDRESS
    mac: MAC_ADDRESS
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='host' href='#host'></a> host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>The hostname/IP address to connect to.</p>
</span></p></dd><dt><a class='title-link' name='mac' href='#mac'></a> mac</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Device MAC address.</p>
</span></p></dd><dt><a class='title-link' name='timeout' href='#timeout'></a> timeout</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Timeout in seconds for the connection to the device.</p>
</span></p><p class='default'>
Default value: <p>5</p>
</p></dd><dt><a class='title-link' name='name' href='#name'></a> name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Name of the device.</p>
</span></p><p class='default'>
Default value: <p>Broadlink</p>
</p></dd></dl>
</div>
<h3>Learn command</h3>
<p>Use the <code>remote.learn_command</code> service to learn new commands.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td>ID of the remote.</td>
</tr>
<tr>
<td><code>device</code></td>
<td>no</td>
<td>Name of the device to control.</td>
</tr>
<tr>
<td><code>command</code></td>
<td>no</td>
<td>Names of the commands to learn.</td>
</tr>
<tr>
<td><code>alternative</code></td>
<td>yes</td>
<td>Toggle commands?</td>
</tr>
<tr>
<td><code>timeout</code></td>
<td>yes</td>
<td>Timeout in seconds to learn each command.</td>
</tr>
</tbody>
</table>
<p>Example 1: Learn a single command</p>
<pre><code class="language-yaml">script:
  learn_mute_tv:
    sequence:
      - service: remote.learn_command
        data:
          entity_id: remote.bedroom
          device: television
          command: mute
</code></pre>
<p>Example 2: Learn a sequence of commands</p>
<pre><code class="language-yaml">script:
  learn_tv_commands:
    sequence:
      - service: remote.learn_command
        data:
          entity_id: remote.bedroom
          device: television
          command:
            - turn on
            - turn off
            - volume up
            - volume down
</code></pre>
<p>Example 3: Learn a toggle command</p>
<p>The <code>alternative</code> flag is useful for capturing commands where the same button is used for more than one purpose, such as the power button, which can turn the television on and off.</p>
<pre><code class="language-yaml">script:
  learn_tv_power_button:
    sequence:
      - service: remote.learn_command
        data:
          entity_id: remote.bedroom
          device: television
          command: power
          alternative: True
</code></pre>
<p>In the above example, two codes will be captured for the power command, and will be sent alternately each time the command is called.</p>
<h3>Send command</h3>
<p>Use the <code>remote.send_command</code> service to send commands.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>no</td>
<td>ID of the remote.</td>
</tr>
<tr>
<td><code>device</code></td>
<td>no</td>
<td>Name of the device to control.</td>
</tr>
<tr>
<td><code>command</code></td>
<td>no</td>
<td>Names of the commands to send.</td>
</tr>
<tr>
<td><code>num_repeats</code></td>
<td>yes</td>
<td>Number of times to repeat the commands.</td>
</tr>
<tr>
<td><code>delay_secs</code></td>
<td>yes</td>
<td>Interval in seconds between one command and another.</td>
</tr>
</tbody>
</table>
<p>Example 1: Send a single command</p>
<pre><code class="language-yaml">script:
  mute_tv:
    sequence:
      - service: remote.send_command
        data:
          entity_id: remote.bedroom
          device: television
          command: mute
</code></pre>
<p>Example 2: Send a command repeatedly</p>
<pre><code class="language-yaml">script:
  turn_up_tv_volume_20:
    sequence:
      - service: remote.send_command
        data:
          entity_id: remote.bedroom
          device: television
          command: volume up
          num_repeats: 20
</code></pre>
<p>Example 3: Send a sequence of commands</p>
<pre><code class="language-yaml">script:
  turn_on_ac:
    sequence:
      - service: remote.send_command
        data:
          entity_id: remote.bedroom
          device: air conditioner
          command:
            - turn on
            - turn off display
</code></pre>
<h2>Sensor</h2>
<p>The <code>broadlink</code> sensor platform let you monitor data from an RM2 and A1 E-air. There is currently no support for the cloud API.</p>
<p>To enable it, add the following lines to your <code>configuration.yaml</code>:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
sensor:
  - platform: broadlink
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    monitored_conditions:
      - 'temperature'
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='host' href='#host'></a> host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>The hostname/IP address to connect to.</p>
</span></p></dd><dt><a class='title-link' name='mac' href='#mac'></a> mac</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Device MAC address. Use the following format: <code>AA:BB:CC:DD:EE:FF</code>.</p>
</span></p></dd><dt><a class='title-link' name='name' href='#name'></a> name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Sensor name.</p>
</span></p><p class='default'>
Default value: <p>Broadlink sensor</p>
</p></dd><dt><a class='title-link' name='scan_interval' href='#scan_interval'></a> scan_interval</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Time in seconds to fetch data from sensors.</p>
</span></p><p class='default'>
Default value: <p>300</p>
</p></dd><dt><a class='title-link' name='timeout' href='#timeout'></a> timeout</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Timeout in seconds for the connection to the device.</p>
</span></p><p class='default'>
Default value: <p>10</p>
</p></dd><dt><a class='title-link' name='monitored_conditions' href='#monitored_conditions'></a> monitored_conditions</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Required)</span><span class='description'></span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='temperature' href='#temperature'></a> 'temperature'</dt><dd><p class='desc'><span class='description'><p>Temperature</p>
</span></p></dd><dt><a class='title-link' name='humidity' href='#humidity'></a> 'humidity'</dt><dd><p class='desc'><span class='description'><p>Humidity</p>
</span></p></dd><dt><a class='title-link' name='air_quality' href='#air_quality'></a> 'air_quality'</dt><dd><p class='desc'><span class='description'><p>Air quality</p>
</span></p></dd><dt><a class='title-link' name='light' href='#light'></a> 'light'</dt><dd><p class='desc'><span class='description'><p>Light</p>
</span></p></dd><dt><a class='title-link' name='noise' href='#noise'></a> 'noise'</dt><dd><p class='desc'><span class='description'><p>Noise</p>
</span></p></dd></dl></dd></dl>
</div>
<p>To set it up, add the following information to your <code>configuration.yaml</code> file:</p>
<p>Obtain sensor data from an A1:</p>
<pre><code class="language-yaml">sensor:
  - platform: broadlink
    scan_interval: 60
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    monitored_conditions:
      - temperature
      - humidity
      - air_quality
      - light
      - noise
</code></pre>
<p>Obtain temperature data from an RM2:</p>
<pre><code class="language-yaml">sensor:
  - platform: broadlink
    scan_interval: 60
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    monitored_conditions:
      - temperature
</code></pre>
<h3>Microsoft Windows installation</h3>
<div class='note'>
<p>The pycrypto library needs to be available on your platform. On a typical windows sysytem <code>pip install pycrypto</code> will fail, as a compiler needs to be installed first.</p>
</div>
<p>The quickest way around this is to use a pre-built binary, e.g., from <a href="https://github.com/sfbahr/PyCrypto-Wheels">https://github.com/sfbahr/PyCrypto-Wheels</a></p>
<p>Be sure to get the correct 64 or 32-bit binary for your system, the full command line will look something like the sample below for a 64-bit system:</p>
<pre><code class="language-bash">pip install --use-wheel --no-index --find-links=https://github.com/sfbahr/PyCrypto-Wheels/raw/master/pycrypto-2.6.1-cp35-none-win_amd64.whl pycrypto
</code></pre>
<h2>Switch</h2>
<p>This <code>Broadlink</code> switch platform allow to you control Broadlink <a href="https://www.ibroadlink.com/">devices</a>.</p>
<h3>Configuration</h3>
<p>To enable it, add the following lines to your <code>configuration.yaml</code>:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
switch:
  - platform: broadlink
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='host' href='#host'></a> host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>The hostname/IP address to connect to.</p>
</span></p></dd><dt><a class='title-link' name='mac' href='#mac'></a> mac</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Device MAC address. Use the following format: <code>AA:BB:CC:DD:EE:FF</code>.</p>
</span></p></dd><dt><a class='title-link' name='timeout' href='#timeout'></a> timeout</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Timeout in seconds for the connection to the device.</p>
</span></p></dd><dt><a class='title-link' name='retry' href='#retry'></a> retry</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Retry times for fetch data if failed.</p>
</span></p><p class='default'>
Default value: <p>2</p>
</p></dd><dt><a class='title-link' name='friendly_name' href='#friendly_name'></a> friendly_name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The name used to display the switch in the frontend.</p>
</span></p></dd><dt><a class='title-link' name='type' href='#type'></a> type</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Switch type. Choose one from: <code>rm</code>, <code>rm2</code>, <code>rm_mini</code>, <code>rm_pro_phicomm</code>, <code>rm2_home_plus</code>, <code>rm2_home_plus_gdt</code>, <code>rm2_pro_plus</code>, <code>rm2_pro_plus2</code>, <code>rm2_pro_plus_bl</code>, <code>rm_mini_shate</code>, <code>sp1</code>, <code>sp2</code>, <code>honeywell_sp2</code>, <code>sp3</code>, <code>spmini2</code>, <code>spminiplus</code> or <code>mp1</code>. <code>SC1</code> devices can be registered as <code>sp2</code>.</p>
</span></p></dd><dt><a class='title-link' name='switches' href='#switches'></a> switches</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The array that contains all switches.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='identifier' href='#identifier'></a> identifier</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Name of the command switch as slug. Multiple entries are possible.</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='command_on' href='#command_on'></a> command_on</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Base64 encoded packet from RM device to take for on.</p>
</span></p></dd><dt><a class='title-link' name='command_off' href='#command_off'></a> command_off</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>Base64 encoded packet from RM device to take for off.</p>
</span></p></dd><dt><a class='title-link' name='friendly_name' href='#friendly_name'></a> friendly_name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The name used to display the switch in the frontend.</p>
</span></p></dd></dl></dd></dl></dd><dt><a class='title-link' name='slots' href='#slots'></a> slots</dt><dd><p class='desc'><span class='type'>(<span class='map'>map</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Friendly names of 4 slots of MP1 power strip. If not configured, slot name will be <code>switch's friendly_name + 'slot {slot_index}'</code>. e.g ‚ÄòMP1 slot 1‚Äô</p>
</span></p></dd><dd><dl class='nested'><dt><a class='title-link' name='slot_1' href='#slot_1'></a> slot_1</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Friendly names of slot 1</p>
</span></p></dd><dt><a class='title-link' name='slot_2' href='#slot_2'></a> slot_2</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Friendly names of slot 2</p>
</span></p></dd><dt><a class='title-link' name='slot_3' href='#slot_3'></a> slot_3</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Friendly names of slot 3</p>
</span></p></dd><dt><a class='title-link' name='slot_4' href='#slot_4'></a> slot_4</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Friendly names of slot 4</p>
</span></p></dd></dl></dd></dl>
</div>
<p>Information about how to install on Windows can be found <a href="/integrations/broadlink#sensor#microsoft-windows-installation">here</a>.</p>
<h3>How to obtain IR/RF packets?</h3>
<p>Choose Call Service from the Developer Tools. Choose the service <code>broadlink.learn</code> from the list of <strong>Available services:</strong>, write in ‚ÄúService Data‚Äù JSON with 1 field ‚Äúhost‚Äù:‚Äúyour_broadlink_IP‚Äù and hit <strong>CALL SERVICE</strong>. Press the button on your remote with in 20 seconds. The packet will be printed as a persistent notification in the States page of the web interface.</p>
<p>Example config for <code>rm</code>, <code>rm2</code>, <code>rm_mini</code>, <code>rm_pro_phicomm</code>, <code>rm2_home_plus</code>, <code>rm2_home_plus_gdt</code>, <code>rm2_pro_plus</code>, <code>rm2_pro_plus2</code>, <code>rm2_pro_plus_bl</code> and <code>rm_mini_shate</code> devices:</p>
<pre><code class="language-yaml">switch:
  - platform: broadlink
    host: 192.168.1.2
    mac: 'B4:43:0D:CC:0F:58'
    timeout: 15
    retry: 5
    switches:
      # Will work on most Phillips TVs:
      tv_phillips:
        friendly_name: &quot;Phillips Tv Power&quot;
        command_on: 'JgAcAB0dHB44HhweGx4cHR06HB0cHhwdHB8bHhwADQUAAAAAAAAAAAAAAAA='
        command_off: 'JgAaABweOR4bHhwdHB4dHRw6HhsdHR0dOTocAA0FAAAAAAAAAAAAAAAAAAA='
      # Will work on most LG TVs
      tv_lg:
        friendly_name: &quot;LG Tv Power&quot;
        command_on: 'JgBYAAABIJISExETETcSEhISEhQQFBETETcROBESEjcRNhM1EjcTNRMTERISNxEUERMSExE2EjYSNhM2EhIROBE3ETcREhITEgAFGwABH0oSAAwzAAEfShEADQU='
        command_off: 'JgBYAAABIJISExETETcSEhISEhQQFBETETcROBESEjcRNhM1EjcTNRMTERISNxEUERMSExE2EjYSNhM2EhIROBE3ETcREhITEgAFGwABH0oSAAwzAAEfShEADQU='
      tv_lg_hdmi1_hdmi2:
        friendly_name: &quot;LG Tv HDMI12&quot;
        command_on: 'JgBIAAABIZMRExITEjYSExMRERURExEUEDkRNxEUEjYSNhM3ETcSNxITETgSNhI2ExMQExE4ETYSNxIUERMSExE4ETcRFBETEQANBQ=='
        command_off: 'JgBQAAABJJMSEhISETgSEhITEBMSEhMSETcSNxMREjcSNxI3EjcSOBETERITNhM2EhITERM2EzcRNxI3ExISEhI3EjcRExETEgAFLQABJEoRAA0FAAAAAAAAAAA='
      tv_lg_hdmi3:
        friendly_name: &quot;LG Tv HDMI3&quot;
        command_on: 'JgBIAAABIZMSFBISETgRExEUERQQFBETEjcTNhMSETgRNxE3EjcROBM2ERMSFBE4ERMSNxM2EjUSFBE2ETgRExM2ExITEhATEwANBQ=='
      tv_lg_av1_av2:
        friendly_name: &quot;LG Tv AV12&quot;
        command_on: 'JgBIAAABIpQPFBITETgSEw8UEhQSEhEVDzgSOBAUETgQOQ84EjgRNxITETgSExA5EDgREhI3EhMROBMSEDkQFBETEjYTEhE4EQANBQ=='
        command_off: 'JgBIAAABH5YPFBETETgUERAUEBURFBATETgROBEUETcSNxE4ETcSOBISEBUQFREUEjUSFBA5ETcRNxE4ETkQOBAUEjcRFRAUEQANBQ=='
  - platform: broadlink
    host: 192.168.1.2
    mac: 'B4:43:0D:CC:0F:58'
    timeout: 15
    switches:
    # Will work on most Phillips TVs:
      tv:
        friendly_name: &quot;Phillips Tv&quot;
        command_on: 'JgAcAB0dHB44HhweGx4cHR06HB0cHhwdHB8bHhwADQUAAAAAAAAAAAAAAAA='
        command_off: 'JgAaABweOR4bHhwdHB4dHRw6HhsdHR0dOTocAA0FAAAAAAAAAAAAAAAAAAA='
</code></pre>
<p>Example config for <code>sp1</code>, <code>sp2</code>, <code>honeywell_sp2</code>, <code>sp3</code>, <code>spmini2</code> and <code>spminiplus</code> devices:</p>
<pre><code class="language-yaml">switch:
  - platform: broadlink
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    type:  sp1
    friendly_name: 'Humidifier'
  - platform: broadlink
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    type:  sp2
    retry: 5
    friendly_name: 'Humidifier'
</code></pre>
<p>Example config for <code>mp1</code> device:</p>
<pre><code class="language-yaml">switch:
  - platform: broadlink
    host: IP_ADDRESS
    mac: 'MAC_ADDRESS'
    type: mp1
    friendly_name: 'MP1'
    slots:
      # friendly name of slots - optional
      # if not set, slot name will be switch's friendly_name + 'slot {slot_index}'. e.g 'MP1 slot 1'
      slot_1: 'TV slot'
      slot_2: 'Xbox slot'
      slot_3: 'Fan slot'
      slot_4: 'Speaker slot'
</code></pre>
<h3>Service <code>broadlink.send</code></h3>
<p>You can use the service <code>broadlink.send</code> to directly send IR packets without the need to assign a switch entity for each command.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>host</code></td>
<td>no</td>
<td>IP address to send command to.</td>
</tr>
<tr>
<td><code>packet</code></td>
<td>no</td>
<td>String or list of strings that contain the packet data.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<pre><code class="language-yaml">script:
  tv_select_source:
    sequence:
      - service: broadlink.send
        data:
          host: 192.168.0.107
          packet:
            - &quot;JgCMAJSSFDYUNhQ2FBEUERQRFBEUERQ2FDYUNhQRFBEUERQRFBEUERQRFDYUERQRFBEUERQRFDYUNhQRFDYUNhQ2FDYUNhQABfWUkhQ2FDYUNhQRFBEUERQRFBEUNhQ2FDYUERQRFBEUERQRFBEUERQ2FBEUERQRFBEUERQ2FDYUERQ2FDYUNhQ2FDYUAA0FAAAAAAAAAAAAAAAA&quot;
            - &quot;JgBGAJSTFDUUNhM2ExITEhMSExITEhM2EzYTNhQRFBEUERQRFBEUNRQ2ExITNhMSExITNhMSExITEhM2ExITNhQ1FBEUNhMADQUAAA==&quot;
</code></pre>
<h3>Using E-Control remotes</h3>
<p>If you already have your remotes learned on E-Control app you can use this method to ‚Äúcopy‚Äù them to Home Assistant.</p>
<p>First get or learn all the remotes you want to add to Home Assistant in E-Control</p>
<ol>
<li>
<p>Download</p>
<p>Get the script from <a href="https://github.com/NightRang3r/Broadlink-e-control-db-dump">here</a>.</p>
</li>
<li>
<p>Dump the data from the app</p>
<p>Open the E-Control app on your mobile device. On the left side menu choose ‚ÄúShare‚Äù and then ‚ÄúShare to other phones in WLAN‚Äù. It will generate the files you will need for the script.</p>
</li>
<li>
<p>Get data from your Android device</p>
<p>Connect your Android device to your computer and browse the SD card/External Storage folder ‚Äú/broadlink/newremote/SharedData/‚Äù. You need to get the following files and put them in the same folder as this script:</p>
<p>jsonSubIr
jsonButton
jsonIrCode</p>
</li>
<li>
<p>Install Requirements</p>
<p>Run <code>pip install simplejson</code>. You must install simplejson in the same python version you will use to run the scripts. You can ensure that the current version is installed by attempting to install again and confirming that you see ‚ÄúRequirement already satisfied‚Äù.</p>
</li>
<li>
<p>Get the data from the device</p>
<p>Navigate to the folder you downloaded and run <code>python getBroadlinkSharedData.py</code>. Follow the steps on screen. NOTE: These scripts were only tested with Python 2.7.</p>
</li>
<li>
<p>Install python-broadlink library:</p>
<pre><code class="language-bash">git clone https://github.com/mjg59/python-broadlink.git
cd python-broadlink
sudo python setup.py install
</code></pre>
</li>
<li>
<p>Test the codes
Use the <code>sendcode</code> script you have already downloaded to test the codes you got from the device.
You need to edit the script with your RM Pro IP Address and MAC Address and with the code in HEX format.
When run the script, you know the code works when get message.
Code sent‚Ä¶
Not every code works.</p>
</li>
<li>
<p>Convert the HEX codes to base64.
Use <a href="https://tomeko.net/online_tools/hex_to_base64.php?lang=en1">this</a> tool to convert the hex codes to base64 for use with Home Assistant.</p>
</li>
</ol>
<h3>Using iOS and Windows to obtain codes</h3>
<ol>
<li>
<p>Use the E-Control app to learn the codes from all of your suitable remotes. Depending on the remote, try to add useful names for the buttons and/or the remotes. This will mean that you should only have to run this process once and will help with getting them quickly into Home Assistant. Dump the files in the app by navigating to the hamburger icon, select <code>share and select</code>, then choose <code>Share to other phones on WLAN</code>.</p>
</li>
<li>
<p>Install Requirements</p>
<ul>
<li>Download and install Python 2.7 on your windows PC.</li>
<li>Run <code>pip install simplejson</code>. You must install simplejson in the same python version you will use to run the scripts. You can ensure that the current version is installed by attempting to install again and confirming that you see ‚ÄúRequirement already satisfied‚Äù.</li>
<li>Download and install <a href="https://www.imactools.com/iphonebackupviewer/">iBackup Viewer</a>.</li>
<li>Download <a href="https://github.com/NightRang3r/Broadlink-e-control-db-dump">these</a> github files. Make sure you place them in the \Python27 path in Windows. Be sure that the getBroadlinkSharedData.py from the download is in this directory.</li>
</ul>
</li>
<li>
<p>Plug your iphone into your windows PC, open iTunes and create a non-encrypted backup of your device.</p>
</li>
<li>
<p>Open iBackup viewer then select the iOS backup that you created. Navigate to the App icon and then scroll until you find e-control.app, select this. Select and extract the files jsonButton, jsonIrCode and jsonSublr; they will be located in the Documents/SharedData section. Put these in the same location as the getBroadlinkSharedData.py.</p>
</li>
<li>
<p>Now open a Command Prompt and navigate to the directory where the aforementioned files are located e.g. C:\Python27. Now run the command python getBroadlinkSharedData.py, you should see something like this:</p>
<pre><code class="language-bash">C:\Python27&gt;python getBroadlinkSharedData.py
ID: 1 | Name: TV
ID: 2 | Name: Upstairs
ID: 3 | Name: Sort in order
ID: 4 | Name: Soundbar
ID: 5 | Name: TV
ID: 6 | Name: Xbox One
ID: 7 | Name: User-Defined Aircon
ID: 8 | Name: Sort in order
ID: 9 | Name: User-Defined Aircon
ID: 10 | Name: Kids Fan
ID: 11 | Name: Downstairs
ID: 12 | Name: Ceiling Fan
ID: 13 | Name: Samsung TV
ID: 14 | Name: Xbox One
ID: 15 | Name: SONY SoundBar
ID: 16 | Name: Fire TV
ID: 17 | Name: New RF Remote
</code></pre>
<p>Select the remote ID you would like to extract:</p>
<pre><code class="language-bash">Select accessory ID: 5
[+] You selected:  TV
[+] Dumping codes to TV.txt
</code></pre>
</li>
<li>
<p>Now there should be a file with the name of the remote you chose in the same directory ending in <code>.txt</code>. Open that up and it will contain the Base64 code required for Home Assistant. To ensure these codes work correctly you may need to add <code>==</code> to the end of the code in your config.yaml file (or wherever you have your switches).</p>
</li>
</ol>
<h3>Using Windows to obtain codes with Broadlink Manager</h3>
<ol>
<li>Install Broadlink Manager from this SourceForge link <a href="https://sourceforge.net/projects/broadlink-manager/">here</a>.</li>
<li>Open the application and hit ‚Äúscan‚Äù to activate your broadlink device.</li>
<li>Hit ‚ÄúLearn New Command‚Äù and follow instructions on screen.</li>
<li>The ‚ÄúOnRawData Base64‚Äù is the value to be used with Home Assistant.</li>
</ol>
<h3>Using Node-RED to obtain codes</h3>
<ol>
<li>Install the Broadlink Control palette in Node-RED (click the Hamburger menu at top right corner&gt; Settings&gt; Palette&gt; Install and type Broadlink. Click install on the node-red-contrib-broadlink-control.</li>
<li>Once installed, verify that the new palette titled broadlink is available in the nodes menu.</li>
<li>Drag the RM node to an empty flow and double click to configure the node.
<pre><code class="language-bash">a. give your RM device a name for easy identification
b. click on the pencil to edit the device information
c. enter the MAC address of the Broadlink RM PRO or RM Mini
d. enter the IP address of the Broadlink RM PRO or RM mini
e. leave the Catalog field empty.
</code></pre>
</li>
<li>Click Update, and the device field should show the MAC address of the newly added device. If not, just select it.</li>
<li>In the Action field, select Learn, then click Done.</li>
<li>Drag an Inject node to the left of the RM node and link them. The type of inject doesn‚Äôt matter. Leave it to the defaults.</li>
<li>Drag a Template node on the Flow to the right of the RM node and link it to the RM node.</li>
<li>Double click the Template node to edit it, select:
<pre><code class="language-bash">Property: msg.payload
Format: Mustache template
Template field: enter '{{payload.data}}'.
Output as: Plain text
</code></pre>
</li>
<li>Drag a Debug node to the right of the Template node and link them.</li>
<li>Show the debug messages, deploy the flow and click on the inject button.</li>
<li>A message will show in the debug window:
<pre><code class="language-bash">3/23/2019, 9:56:53 AMnode: RM_Mini1
msg : string[47]
&quot;Please tap the remote button within 30 seconds.&quot;
</code></pre>
</li>
<li>Point the IR remote control at the RM device and click the desired button for about 2 seconds. An array of numbers will show in the debug window. For example:
<pre><code class="language-bash">'38,0,132,3,19,18,19,18,19,18,19,17,20,54,20,54,20,54,19,18,19,18,19,18,19,17,20,17,20,17,20,54,20,17,19,18,19,18,19,18,19,17,20,17,20,54,20,17,20,54,19,55,19,54,20,54,20,54,19,55,19,0,6,6,150,146,20,54,20,54,20,54,19,18,19,18,19,18,19,17,20,17,20,54,20,54,19,55,19,18,19,17,20,17,20,17,20,17,20,17,20,54,19,18,19,18,19,18,19,17,20,17,20,17,20,54,19,18,19,55,19,54,20,54,20,54,20,54,19,55,19,0,6,6,150,146,20,54,20,54,19,55,19,18,19,17,20,17,20,17,20,17,20,54,19,55,19,54,20,17,20,17,20,17,20,17,20,17,19,18,19,55,19,17,20,17,20,17,20,17,20,17,19,18,19,55,19,18,19,54,20,54,20,54,19,55,19,54,20,54,20,0,6,5,150,146,20,54,20,54,20,54,19,18,19,18,19,18,19,17,20,17,20,54,20,54,19,55,19,18,19,17,20,17,20,17,20,17,20,17,20,54,19,18,19,18,19,18,19,17,20,17,20,17,20,54,19,18,19,55,19,54,20,54,20,54,19,55,19,54,20,0,6,6,149,147,20,54,19,55,19,54,20,17,20,17,20,17,20,17,20,17,19,55,19,54,20,54,20,17,20,17,20,17,19,18,19,18,19,18,19,54,20,17,20,17,20,17,20,17,19,18,19,18,19,54,20,17,20,54,20,54,20,54,19,...'
</code></pre>
</li>
</ol>
<p>This is the code we need to transmit again to replicate the same remote function.</p>
<h3>Using Node red to Transmit Codes</h3>
<ol>
<li>Drag another RM node on the same flow we created earlier. The RM node should be configured to the RM device created earlier by default.</li>
<li>In the Action field, select - Set from msg.payload -.</li>
<li>Drag an Inject node and give it a meaningful name relevant to the remote control button function, like ‚ÄúTV On‚Äù or ‚ÄúTV Source‚Äù.</li>
<li>Drag a template node and double click it to configure:
<pre><code class="language-bash">Property: msg.payload
Format: Mustache template
Template: enter the following:
'{
   &quot;action&quot; : &quot;send&quot;,
   &quot;data&quot; : [ 38, 0, 34, 1, 40, 15, 40, 15 ] // Here you must enter the entire code from point 12 above, without the trailing &quot;.&quot;
}'
In the Output as field, &quot;select Parsed JSON&quot;.
</code></pre>
</li>
<li>Click Done.</li>
<li>Drag a debug node and connect it to the output of the RM node.</li>
<li>Connect the Inject node to the Template node, and the template node to the RM node.</li>
<li>Click Deploy to activate the flow, and then click the inject button. The debug window should show a debug message. For example:
<pre><code class="language-bash">{&quot;action&quot;:&quot;send&quot;,&quot;data&quot;:   [38,0,152,0,0,1,39,148,19,18,18,19,18,55,19,18,18,19,18,19,18,19,18,55,18,56,18,19,18,55,18,19,18,56,18,18,19,55,18,19,18,19,18,18,18,56,18,19,18,18,19,55,18,56,18,18,19,18,18,19,18,19,18,55,19,18,18,19,18,19,18,19,18,18,18,19,18,19,18,55,19,55,18,19,18,19,18,18,19,18,18,56,18,19,18,18,19,55,18,56,18,18,19,18,18,19,18,19,18,19,18,18,19,18,18,56,18,55,18,19,18,19,18,19,18,18,19,55,18,19,18,55,19,18,18,56,18,19,18,18,19,18,18,19,18,19,18,19,18,18,18,56,18,0,13,5],&quot;status&quot;:&quot;OK&quot;}
</code></pre>
</li>
</ol>
<p>The ‚Äústatus‚Äù : ‚ÄúOK‚Äù at the end is a feedback that the Broadlink RM device is connected and has transmitted the payload.</p>
<p>Now you can add as many template nodes, each having a specific code, and add any type of input nodes to activate the template and transmit the code.</p>
<h3>Using broadlink_cli to obtain codes</h3>
<p>It is also possible to obtain codes using <code>broadlink_cli</code> from <a href="https://github.com/mjg59/python-broadlink">python-broadlink</a> project.
First use discovery to find your Broadlink device:</p>
<pre><code class="language-bash">./broadlink_discovery 
Discovering...
###########################################
RM2
# broadlink_cli --type 0x2737 --host 192.168.1.137 --mac 36668342f7c8
Device file data (to be used with --device @filename in broadlink_cli) : 
0x2737 192.168.1.137 36668342nnnn
temperature = 0.0
</code></pre>
<p>Then use this info in a cli-command:</p>
<pre><code class="language-bash">./broadlink_cli  --learn --device &quot;0x2737 192.168.1.137 36668342nnnn&quot;
Learning...
</code></pre>
<p>Press a button on the remote and you get a code:</p>
<pre><code class="language-txt">260058000001219512131114113910141114111411141114103911391114103911391139103911391039113911141039111411391015103911141114113910141139111410391114110005250001274b11000c520001274b11000d05
Base64: b'JgBYAAABIZUSExEUETkQFBEUERQRFBEUEDkROREUEDkRORE5EDkRORA5ETkRFBA5ERQRORAVEDkRFBEUETkQFBE5ERQQOREUEQAFJQABJ0sRAAxSAAEnSxEADQU='
</code></pre>
<h3>Conversion of codes from other projects</h3>
<p>For old/awkward devices another possibility is to try to get codes by using data gathered by the LIRC project.</p>
<p>Assuming that your (or similar) device is in one of these databases:</p>
<ul>
<li><a href="https://sourceforge.net/p/lirc-remotes/code/ci/master/tree/">https://sourceforge.net/p/lirc-remotes/code/ci/master/tree/</a></li>
<li><a href="https://github.com/probonopd/irdb/tree/master/">https://github.com/probonopd/irdb/tree/master/</a></li>
</ul>
<p>You can grab <code>irdb2broadlinkha.sh</code> from <a href="https://github.com/molexx/irdb2broadlinkha">irdb2broadlinkha</a> project and try to convert codes to format suitable for Home Assistant.</p>
:ET