I"ÒF<p>The <code>http</code> integration serves all files and data required for the Home Assistant frontend. You only need to add this to your configuration file if you want to change any of the default settings.</p>
<p>There is currently support for the following device types within Home Assistant:</p>
<ul>
<li><a href="#binary-sensor">Binary Sensor</a></li>
<li><a href="#sensor">Sensor</a></li>
</ul>
<div class='note'>
<p>Don‚Äôt use option <code>server_host</code> on a Hass.io installation!</p>
</div>
<pre><code class="language-yaml"># Example configuration.yaml entry
http:
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='server_host' href='#server_host'></a> server_host</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Only listen to incoming requests on specific IP/host. By default it will accept all IPv4 connections. Use <code>server_host: ::0</code> if you want to listen to (and only) IPv6.</p>
</span></p><p class='default'>
Default value: <p>0.0.0.0</p>
</p></dd><dt><a class='title-link' name='server_port' href='#server_port'></a> server_port</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Let you set a port to use.</p>
</span></p><p class='default'>
Default value: <p>8123</p>
</p></dd><dt><a class='title-link' name='base_url' href='#base_url'></a> base_url</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The URL that Home Assistant is available on the internet. For example: <code>https://hass-example.duckdns.org:8123</code>. The iOS app finds local installations, if you have an outside URL use this so that you can auto-fill when discovered in the app. Note that this setting may only contain a protocol, hostname and port; using a path is <em>not</em> currently supported.</p>
</span></p><p class='default'>
Default value: <p>Your local IP address</p>
</p></dd><dt><a class='title-link' name='ssl_certificate' href='#ssl_certificate'></a> ssl_certificate</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Path to your TLS/SSL certificate to serve Home Assistant over a secure connection.</p>
</span></p></dd><dt><a class='title-link' name='ssl_peer_certificate' href='#ssl_peer_certificate'></a> ssl_peer_certificate</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Path to the client/peer TLS/SSL certificate to accept secure connections from.</p>
</span></p></dd><dt><a class='title-link' name='ssl_key' href='#ssl_key'></a> ssl_key</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Path to your TLS/SSL key to serve Home Assistant over a secure connection.</p>
</span></p></dd><dt><a class='title-link' name='cors_allowed_origins' href='#cors_allowed_origins'></a> cors_allowed_origins</dt><dd><p class='desc'><span class='type'>(<span class='string list'>string | list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>A list of origin domain names to allow <a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> requests from. Enabling this will set the <code>Access-Control-Allow-Origin</code> header to the Origin header if it is found in the list, and the <code>Access-Control-Allow-Headers</code> header to <code>Origin, Accept, X-Requested-With, Content-type, Authorization</code>. You must provide the exact Origin, i.e. <code>https://www.home-assistant.io</code> will allow requests from <code>https://www.home-assistant.io</code> but <strong>not</strong> <code>http://www.home-assistant.io</code>.</p>
</span></p></dd><dt><a class='title-link' name='use_x_forwarded_for' href='#use_x_forwarded_for'></a> use_x_forwarded_for</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Enable parsing of the <code>X-Forwarded-For</code> header, passing on the client‚Äôs correct IP address in proxied setups. You <strong>must</strong> also whitelist trusted proxies using the <code>trusted_proxies</code> setting for this to work. Non-whitelisted requests with this header will be considered IP spoofing attacks, and the header will, therefore, be ignored.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='trusted_proxies' href='#trusted_proxies'></a> trusted_proxies</dt><dd><p class='desc'><span class='type'>(<span class='string list'>string | list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>List of trusted proxies, consisting of IP addresses or networks, that are allowed to set the <code>X-Forwarded-For</code> header.  This is required when using <code>use_x_forwarded_for</code> because all requests to Home Assistant, regardless of source, will arrive from the reverse proxy IP address. Therefore in a reverse proxy scenario, this option should be set with extreme care.</p>
</span></p></dd><dt><a class='title-link' name='trusted_networks' href='#trusted_networks'></a> trusted_networks</dt><dd><p class='desc'><span class='type'>(<span class='string list'>string | list</span>)</span><span class='required'>(Optional)</span><span class='description'><p><strong>Deprecated since 0.89 release. Configuration moved to <a href="/docs/authentication/providers/#trusted-networks">Trusted Networks auth provider</a>.</strong> List of trusted networks, consisting of IP addresses or networks, that are allowed to bypass password protection when accessing Home Assistant.  If using a reverse proxy with the <code>use_x_forwarded_for</code> and <code>trusted_proxies</code> options enabled, requests proxied to Home Assistant with a trusted <code>X-Forwarded-For</code> header will appear to come from the IP given in that header instead of the proxy IP.</p>
</span></p></dd><dt><a class='title-link' name='ip_ban_enabled' href='#ip_ban_enabled'></a> ip_ban_enabled</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Flag indicating whether additional IP filtering is enabled.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd><dt><a class='title-link' name='login_attempts_threshold' href='#login_attempts_threshold'></a> login_attempts_threshold</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Number of failed login attempt from single IP after which it will be automatically banned if <code>ip_ban_enabled</code> is <code>true</code>. When set to -1 no new automatic bans will be added.</p>
</span></p><p class='default'>
Default value: <p>-1</p>
</p></dd><dt><a class='title-link' name='ssl_profile' href='#ssl_profile'></a> ssl_profile</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The <a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Mozilla SSL profile</a> to use. Only lower if you are experiencing integrations causing SSL handshake errors.</p>
</span></p><p class='default'>
Default value: <p>modern</p>
</p></dd></dl>
</div>
<div class='note'>
<p>Configuring trusted_networks via the <code>http</code> integration will be deprecated and moved to <code>auth_providers</code> instead. For instructions, see <a href="/docs/authentication/providers/#trusted-networks">trusted networks</a>. In Home Assistant 0.89.0 and 0.89.1, you need place the trusted network under both <code>http</code> and <code>auth_providers</code> if you still want to use trusted networks features. You can remove it from <code>http</code> section starting from 0.89.2.</p>
</div>
<p>The sample below shows a configuration entry with possible values:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
http:
  server_port: 12345
  ssl_certificate: /etc/letsencrypt/live/hass.example.com/fullchain.pem
  ssl_key: /etc/letsencrypt/live/hass.example.com/privkey.pem
  cors_allowed_origins:
    - https://google.com
    - https://www.home-assistant.io
  use_x_forwarded_for: true
  trusted_proxies:
    - 10.0.0.200
  ip_ban_enabled: true
  login_attempts_threshold: 5
</code></pre>
<p>The <a href="/blog/2015/12/13/setup-encryption-using-lets-encrypt/">Set up encryption using Let‚Äôs Encrypt</a> blog post gives you details about the encryption of your traffic using free certificates from <a href="https://letsencrypt.org/">Let‚Äôs Encrypt</a>.</p>
<p>Or use a self signed certificate following the instructions here <a href="/docs/ecosystem/certificates/tls_self_signed_certificate/">Self-signed certificate for SSL/TLS</a>.</p>
<h2>APIs</h2>
<p>On top of the <code>http</code> integration is a <a href="/developers/rest_api/">REST API</a>, <a href="/developers/python_api/">Python API</a> and <a href="/developers/websocket_api/">WebSocket API</a> available. There is also support for <a href="/developers/server_sent_events/">Server-sent events</a>.</p>
<p>The <code>http</code> platforms are not real platforms within the meaning of the terminology used around Home Assistant. Home Assistant‚Äôs <a href="/developers/rest_api/">REST API</a> sends and receives messages over HTTP.</p>
<h2>HTTP sensors</h2>
<p>To use those kind of <a href="#sensor">sensors</a> or <a href="#binary-sensor">binary sensors</a> in your installation no configuration in Home Assistant is needed. All configuration is done on the devices themselves. This means that you must be able to edit the target URL or endpoint and the payload. The entity will be created after the first message has arrived.</p>
<p>Create a <a href="https://developers.home-assistant.io/docs/en/auth_api.html#long-lived-access-token">Long-Lived Access Tokens</a> in the Home Assistant UI at the bottom of your profile if you want to use HTTP sensors.</p>
<p>All <a href="/developers/rest_api/#post-apistatesltentity_id">requests</a> need to be sent to the endpoint of the device and must be <strong>POST</strong>.</p>
<h2>IP filtering and banning</h2>
<p>If you want to apply additional IP filtering, and automatically ban brute force attempts, set <code>ip_ban_enabled</code> to <code>true</code> and the maximum number of attempts. After the first ban, an <code>ip_bans.yaml</code> file will be created in the root configuration folder. It will have the banned IP address and time in UTC when it was added:</p>
<pre><code class="language-yaml">127.0.0.1:
  banned_at: '2016-11-16T19:20:03'
</code></pre>
<p>After a ban is added a Persistent Notification is populated to the Home Assistant frontend.</p>
<div class='note warning'>
<p>Please note, that sources from <code>trusted_networks</code> won‚Äôt be banned automatically.</p>
</div>
<h2>Hosting files</h2>
<p>If you want to use Home Assistant to host or serve static files then create a directory called <code>www</code> under the configuration path (<code>/config</code> on Hass.io, <code>.homeassistant</code> elsewhere). The static files in <code>www/</code> can be accessed by the following URL <code>http://your.domain:8123/local/</code>, for example <code>audio.mp3</code> would be accessed as <code>http://your.domain:8123/local/audio.mp3</code>.</p>
<div class='note'>
<p>If you‚Äôve had to create the <code>www/</code> folder for the first time, you‚Äôll need to restart Home Assistant.</p>
</div>
<div class='note warning'>
<p>Files served from the <code>www</code>/<code>local</code> folder, aren‚Äôt protected by the Home Assistant authentication. Files stored in this folder, if the URL is known, can be accessed by anybody without authentication.</p>
</div>
<h2>Binary Sensor</h2>
<p>The HTTP binary sensor is dynamically created with the first request that is made to its URL. You don‚Äôt have to define it in the configuration first.</p>
<p>The sensor will then exist as long as Home Assistant is running. After a restart of Home Assistant the sensor will be gone until it is triggered again.</p>
<p>The URL for a binary sensor looks like the example below:</p>
<pre><code class="language-bash">http://IP_ADDRESS:8123/api/states/binary_sensor.DEVICE_NAME
</code></pre>
<div class='note'>
You should choose a unique device name (DEVICE_NAME) to avoid clashes with other devices.
</div>
<p>The JSON payload must contain the new state and can have a friendly name. The friendly name is used in the frontend to name the sensor.</p>
<pre><code class="language-json">{&quot;state&quot;: &quot;on&quot;, &quot;attributes&quot;: {&quot;friendly_name&quot;: &quot;Radio&quot;}}
</code></pre>
<p>For a quick test <code>curl</code> can be useful to ‚Äúsimulate‚Äù a device.</p>
<pre><code class="language-bash">$ curl -X POST -H &quot;Authorization: Bearer LONG_LIVED_ACCESS_TOKEN&quot; \
    -H &quot;Content-Type: application/json&quot; \
    -d '{&quot;state&quot;: &quot;off&quot;, &quot;attributes&quot;: {&quot;friendly_name&quot;: &quot;Radio&quot;}}' \
    http://localhost:8123/api/states/binary_sensor.radio
</code></pre>
<p>To check if the sensor is working, use again <code>curl</code> to retrieve the <a href="/developers/rest_api/#get-apistatesltentity_id">current state</a>.</p>
<pre><code class="language-bash">$ curl -X GET -H &quot;Authorization: Bearer LONG_LIVED_ACCESS_TOKEN&quot; \
       -H &quot;Content-Type: application/json&quot; \
       http://localhost:8123/api/states/binary_sensor.radio
{
    &quot;attributes&quot;: {
        &quot;friendly_name&quot;: &quot;Radio&quot;
    },
    &quot;entity_id&quot;: &quot;binary_sensor.radio&quot;,
    &quot;last_changed&quot;: &quot;16:45:51 05-02-2016&quot;,
    &quot;last_updated&quot;: &quot;16:45:51 05-02-2016&quot;,
    &quot;state&quot;: &quot;off&quot;
}
</code></pre>
<h3>Examples</h3>
<p>In this section you‚Äôll find some real-life examples of how to use this sensor, besides <code>curl</code>, which was shown earlier.</p>
<h4>Using Python request module</h4>
<p>As already shown on the <a href="/developers/rest_api/">API</a> page, it‚Äôs very simple to use Python and the <a href="https://requests.kennethreitz.org/en/latest/">Requests</a> module for the interaction with Home Assistant.</p>
<pre><code class="language-python">response = requests.post(
    &quot;http://localhost:8123/api/states/binary_sensor.radio&quot;,
    headers={
        &quot;Authorization&quot;: &quot;Bearer LONG_LIVED_ACCESS_TOKEN&quot;,
        &quot;content-type&quot;: &quot;application/json&quot;,
    },
    data=json.dumps({&quot;state&quot;: &quot;on&quot;, &quot;attributes&quot;: {&quot;friendly_name&quot;: &quot;Radio&quot;}}),
)
print(response.text)
</code></pre>
<h4>Using <code>httpie</code></h4>
<p><a href="https://github.com/jkbrzt/httpie"><code>httpie</code></a> is a user-friendly CLI HTTP client.</p>
<pre><code class="language-bash">$ http -v POST http://localhost:8123/api/states/binary_sensor.radio \
      'Authorization:Bearer LONG_LIVED_ACCESS_TOKEN' content-type:application/json state=off \
      attributes:='{&quot;friendly_name&quot;: &quot;Radio&quot;}'
</code></pre>
<h2>Sensor</h2>
<p>The HTTP sensor is dynamically created with the first request that is made to its URL. You don‚Äôt have to define it in the configuration first.</p>
<p>The sensor will then exist as long as Home Assistant is running. After a restart of Home Assistant the sensor will be gone until it is triggered again.</p>
<p>The URL for a sensor looks like the example below:</p>
<pre><code class="language-bash">http://IP_ADDRESS:8123/api/states/sensor.DEVICE_NAME
</code></pre>
<div class='note'>
You should choose a unique device name (DEVICE_NAME) to avoid clashes with other devices.
</div>
<p>The JSON payload must contain the new state and should include the unit of measurement and a friendly name. The friendly name is used in the frontend to name the sensor.</p>
<pre><code class="language-json">{&quot;state&quot;: &quot;20&quot;, &quot;attributes&quot;: {&quot;unit_of_measurement&quot;: &quot;¬∞C&quot;, &quot;friendly_name&quot;: &quot;Bathroom Temperature&quot;}}
</code></pre>
<p>For a quick test, <code>curl</code> can be useful to ‚Äúsimulate‚Äù a device.</p>
<pre><code class="language-bash">$ curl -X POST -H &quot;Authorization: Bearer LONG_LIVED_ACCESS_TOKEN&quot; \
       -H &quot;Content-Type: application/json&quot; \
       -d '{&quot;state&quot;: &quot;20&quot;, &quot;attributes&quot;: {&quot;unit_of_measurement&quot;: &quot;¬∞C&quot;, &quot;friendly_name&quot;: &quot;Bathroom Temp&quot;}}' \
       http://localhost:8123/api/states/sensor.bathroom_temperature
</code></pre>
<p>You can then use <code>curl</code> again to retrieve the <a href="/developers/rest_api/#get-apistatesltentity_id">current sensor state</a> and verify the sensor is working.</p>
<pre><code class="language-bash">$ curl -X GET -H &quot;Authorization: Bearer LONG_LIVED_ACCESS_TOKEN&quot; \
       -H &quot;Content-Type: application/json&quot; \
       http://localhost:8123/api/states/sensor.bathroom_temperature
{
    &quot;attributes&quot;: {
        &quot;friendly_name&quot;: &quot;Bathroom Temp&quot;,
        &quot;unit_of_measurement&quot;: &quot;\u00b0C&quot;
    },
    &quot;entity_id&quot;: &quot;sensor.bathroom_temperature&quot;,
    &quot;last_changed&quot;: &quot;09:46:17 06-02-2016&quot;,
    &quot;last_updated&quot;: &quot;09:48:46 06-02-2016&quot;,
    &quot;state&quot;: &quot;20&quot;
}
</code></pre>
<p>For more examples please visit the <a href="#examples">HTTP Binary Sensor</a> page.</p>
:ET