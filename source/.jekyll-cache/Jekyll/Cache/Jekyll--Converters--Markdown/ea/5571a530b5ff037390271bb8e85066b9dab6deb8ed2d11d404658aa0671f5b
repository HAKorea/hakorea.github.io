I"†<p>The <code>ffmpeg</code> platform allows you to use any video feed with <a href="https://www.ffmpeg.org/">FFmpeg</a> for motion sensors in Home Assistant.</p>
<div class='note'>
<p>If the <code>ffmpeg</code> process is broken, the sensor will be unavailable. To control the ffmpeg process of sensor, use the service <em>ffmpeg.start</em>, <em>ffmpeg.stop</em>, <em>ffmpeg.restart</em>.</p>
</div>
<h2>Motion</h2>
<p>FFmpeg doesnâ€™t have a motion detection filter, but can use a scene filter to detect a new scene/motion. You can set how much needs to change in order to detect motion with the option â€˜changesâ€™, the percent value of change between frames. If you want a really small value for â€˜changesâ€™, you can also add a denoise filter.</p>
<h2>Configuration</h2>
<p>To add FFmpeg with motion detection to your installation, add the following to your <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
binary_sensor:
  - platform: ffmpeg_motion
    input: FFMPEG_SUPPORTED_INPUT
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='input' href='#input'></a> input</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Required)</span><span class='description'><p>An FFmpeg-compatible input file, stream, or feed.</p>
</span></p></dd><dt><a class='title-link' name='name' href='#name'></a> name</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Override the name of your camera for the frontend.</p>
</span></p></dd><dt><a class='title-link' name='initial_state' href='#initial_state'></a> initial_state</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Start <code>ffmpeg</code> with Home Assistant.</p>
</span></p><p class='default'>
Default value: <p>true</p>
</p></dd><dt><a class='title-link' name='changes' href='#changes'></a> changes</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>How much needs to change between two frames to detect it as motion, value in percentage (a lower value is more sensitive).</p>
</span></p><p class='default'>
Default value: <p>10</p>
</p></dd><dt><a class='title-link' name='reset' href='#reset'></a> reset</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The time to reset the state after no new motion is detected.</p>
</span></p><p class='default'>
Default value: <p>20</p>
</p></dd><dt><a class='title-link' name='repeat' href='#repeat'></a> repeat</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>How many events need to be detected in <em>repeat_time</em> in order to trigger a motion, 0 repeats means deactivated.</p>
</span></p><p class='default'>
Default value: <p>0</p>
</p></dd><dt><a class='title-link' name='repeat_time' href='#repeat_time'></a> repeat_time</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>The span of time <em>repeat</em> events need to occur in before triggering a motion, 0 seconds means deactivated.</p>
</span></p><p class='default'>
Default value: <p>0</p>
</p></dd><dt><a class='title-link' name='extra_arguments' href='#extra_arguments'></a> extra_arguments</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Extra options to pass to <code>ffmpeg</code>, e.g., video denoise filtering.</p>
</span></p></dd></dl>
</div>
<p>To experiment with values (changes/100 is the scene value in <code>ffmpeg</code>):</p>
<pre><code class="language-bash">$ ffmpeg -i YOUR_INPUT -an -filter:v select=gt(scene\,0.1) -f framemd5 -
</code></pre>
<p>If you are running into trouble with this sensor, please refer to the <a href="/integrations/ffmpeg/#troubleshooting">troubleshooting section</a>.</p>
<h4>Tips</h4>
<ul>
<li>Use motion only in a custom area with <a href="https://ffmpeg.org/ffmpeg-filters.html#crop">crop filter</a>:</li>
</ul>
<pre><code class="language-yaml">extra_arguments: -filter:v &quot;crop=100:100:12:34&quot;
</code></pre>
:ET