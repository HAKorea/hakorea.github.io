I"O<p>The <code>media_extractor</code> integration gets a stream URL and sends it to a media player entity. This integration can extract entity specific streams if configured accordingly.</p>
<div class='note'>
Media extractor doesn't transcode streams, it just tries to find stream that match requested query.
</div>
<p>To use the media extractor service in your installation, add the following to your <code>configuration.yaml</code> file:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
media_extractor:
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='default_query' href='#default_query'></a> default_query</dt><dd><p class='desc'><span class='type'>(<span class='string'>string</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Set default stream query for all devices.</p>
</span></p><p class='default'>
Default value: <p>best</p>
</p></dd><dt><a class='title-link' name='customize' href='#customize'></a> customize</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Set entity specific values.</p>
</span></p></dd></dl>
</div>
<pre><code class="language-yaml"># Example configuration.yaml entry
media_extractor:
  default_query: worst
  customize:
    media_player.my_sonos:
      video: bestvideo
      music: bestaudio[ext=mp3]
</code></pre>
<p>This configuration sets query for all service calls like to â€˜bestaudioâ€™ with the mp3 extension:</p>
<pre><code class="language-json">{
  &quot;entity_id&quot;: &quot;media_player.my_sonos&quot;,
  &quot;media_content_id&quot;: &quot;https://soundcloud.com/bruttoband/brutto-11&quot;,
  &quot;media_content_type&quot;: &quot;music&quot;
}
</code></pre>
<p>Query examples with explanations:</p>
<ul>
<li><strong>bestvideo</strong>: Best video only stream</li>
<li><strong>best</strong>: Best video + audio stream</li>
<li><strong>bestaudio[ext=m4a]</strong>: Best audio stream with m4a extension</li>
<li><strong>worst</strong>: Worst video + audio stream</li>
<li><strong>bestaudio[ext=m4a]/bestaudio[ext=ogg]/bestaudio</strong>: Best m4a audio, otherwise best ogg audio and only then any best audio</li>
</ul>
<p>More info about queries <a href="https://github.com/rg3/youtube-dl#format-selection">here</a></p>
<h3>Use the service</h3>
<p>Use <img src='/images/screenshots/developer-tool-services-icon.png' alt='service developer tool icon' class="no-shadow" height="38" /> <strong>Services</strong> from the <strong>Developer Tools</strong>. Choose <code>media_extractor</code> from the dropdown menu <strong>Domain</strong> and <code>play_media</code> from <strong>Service</strong>, enter something like the JSON sample from above into the <strong>Service Data</strong> field, and hit <strong>CALL SERVICE</strong>.</p>
<p>This will download the file from the given URL.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entity_id</code></td>
<td>yes</td>
<td>Name(s) of entities to seek media on, e.g., <code>media_player.living_room_chromecast</code>. Defaults to all.</td>
</tr>
<tr>
<td><code>media_content_id</code></td>
<td>no</td>
<td>The ID of the content to play. Platform dependent.</td>
</tr>
<tr>
<td><code>media_content_type</code></td>
<td>no</td>
<td>The type of the content to play. Must be one of MUSIC, TVSHOW, VIDEO, EPISODE, CHANNEL or PLAYLIST MUSIC.</td>
</tr>
</tbody>
</table>
:ET