I"<p>The <code>speedtestdotnet</code> integration uses the <a href="https://speedtest.net/">Speedtest.net</a> web service to measure network bandwidth performance.</p>
<p>Enabling this integration will automatically create Speedtest.net sensors for the monitored conditions (below).</p>
<p>By default, a speed test will be run every hour. The user can change the update frequency in the configuration by defining the <code>scan_interval</code> for a speed test to run.</p>
<p>Most Speedtest.net servers require TCP port 8080 outbound to function. Without this port open you may experience significant delays or no results at all. See note on their <a href="https://www.speedtest.net/help">help page</a>.</p>
<h2>Configuration</h2>
<p>For the <code>server_id</code> check the list of <a href="http://www.speedtestserver.com">available servers</a>.</p>
<p>To add Speedtest.net sensors to your installation, add the following to your <code>configuration.yaml</code> file:</p>
<p>Once per hour, on the hour (default):</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
speedtestdotnet:
</code></pre>
<div class="config-vars">
  <h3><a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class=''><dt><a class='title-link' name='monitored_conditions' href='#monitored_conditions'></a> monitored_conditions</dt><dd><p class='desc'><span class='type'>(<span class='list'>list</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Sensors to display in the frontend.</p>
</span></p><p class='default'>
Default value: <p>All keys</p>
</p></dd><dd><dl class='nested'><dt><a class='title-link' name='ping' href='#ping'></a> ping</dt><dd><p class='desc'><span class='description'><p>Reaction time in ms of your connection (how fast you get a response after you’ve sent out a request).</p>
</span></p></dd><dt><a class='title-link' name='download' href='#download'></a> download</dt><dd><p class='desc'><span class='description'><p>The download speed (Mbit/s).</p>
</span></p></dd><dt><a class='title-link' name='upload' href='#upload'></a> upload</dt><dd><p class='desc'><span class='description'><p>The upload speed (Mbit/s).</p>
</span></p></dd></dl></dd><dt><a class='title-link' name='server_id' href='#server_id'></a> server_id</dt><dd><p class='desc'><span class='type'>(<span class='integer'>integer</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Specify the speed test server to perform the test against.</p>
</span></p></dd><dt><a class='title-link' name='scan_interval' href='#scan_interval'></a> scan_interval</dt><dd><p class='desc'><span class='type'>(<span class='time'>time</span>)</span><span class='required'>(Optional)</span><span class='description'><p>Minimum time interval between updates. Supported formats: <code>scan_interval: 'HH:MM:SS'</code>, <code>scan_interval: 'HH:MM'</code> and Time period dictionary (see example below).</p>
</span></p><p class='default'>
Default value: <p>60 minutes</p>
</p></dd><dt><a class='title-link' name='manual' href='#manual'></a> manual</dt><dd><p class='desc'><span class='type'>(<span class='boolean'>boolean</span>)</span><span class='required'>(Optional)</span><span class='description'><p><code>true</code> or <code>false</code> to turn manual mode on or off. Manual mode will disable scheduled speed tests.</p>
</span></p><p class='default'>
Default value: <p>false</p>
</p></dd></dl>
</div>
<h3>Time period dictionary example</h3>
<pre><code class="language-yaml">scan_interval:
  # At least one of these must be specified:
  days: 0
  hours: 0
  minutes: 3
  seconds: 30
  milliseconds: 0
</code></pre>
<h3>Service</h3>
<p>Once loaded, the <code>speedtestdotnet</code> integration will expose a service (<code>speedtestdotnet.speedtest</code>) that can be called to run a Speedtest.net speed test on demand. This service takes no parameters. This can be useful if you have enabled manual mode.</p>
<pre><code class="language-yaml">action:
  service: speedtestdotnet.speedtest
</code></pre>
<p>This integration uses <a href="https://github.com/sivel/speedtest-cli">speedtest-cli</a> to gather network performance data from Speedtest.net.
Please be aware of the potential <a href="https://github.com/sivel/speedtest-cli#inconsistency">inconsistencies</a> that this integration may display.</p>
<p>When Home Assistant first starts up, the values of the speed test sensors will show as <code>Unknown</code>. You can use the service <code>speedtestdotnet.speedtest</code> to run a manual speed test and populate the data or just wait for the next regularly scheduled test. You can turn on manual mode to disable the scheduled speed tests.</p>
<h2>Examples</h2>
<p>In this section you will find some real-life examples of how to use this component.</p>
<h3>Run periodically</h3>
<p>Every half hour of every day:</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
speedtestdotnet:
  scan_interval:
    minutes: 30
  monitored_conditions:
    - ping
    - download
    - upload
</code></pre>
<h3>Using as a trigger in an automation</h3>
<pre><code class="language-yaml"># Example configuration.yaml entry
automation:
  - alias: &quot;Internet Speed Glow Connect Great&quot;
    trigger:
      - platform: template
        value_template: &quot;{{ states('sensor.speedtest_download')|float &gt;= 10 }}&quot;
    action:
      - service: shell_command.green

  - alias: &quot;Internet Speed Glow Connect Poor&quot;
    trigger:
      - platform: template
        value_template: &quot;{{ states('sensor.speedtest_download')|float &lt; 10 }}&quot;
    action:
      - service: shell_command.red
</code></pre>
<h2>Notes</h2>
<ul>
<li>When running on Raspberry Pi the maximum speed is limited by the LAN adapter. The Raspberry Pi 3+ models come with a Gigabit LAN adapter which supports a <a href="https://www.raspberrypi.org/products/raspberry-pi-3-model-b-plus/">maximum throughput</a> of 300 Mbit/s.</li>
<li>Running this integration can have negative effects on the system’s performance as it requires a fair amount of memory.</li>
<li>Entries under <code>monitored_conditions</code> only control which entities are available in Home Assistant, they do not disable conditions from running.</li>
<li>If run frequently, this integration has the ability to use a considerable amount of data. Frequent updates should be avoided on bandwidth-capped connections.</li>
<li>While the speedtest is running your network capacity is fully utilized. This may have a negative effect on other devices using the network such as gaming consoles or streaming boxes.</li>
</ul>
:ET