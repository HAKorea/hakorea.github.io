<!doctype html>
  <!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>MySensors - 홈어시스턴트</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Instructions on how to integrate MySensors sensors into Home Assistant.">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://hakorea.github.io/integrations/mysensors/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="MySensors">
    <meta property="og:site_name" content="홈어시스턴트">
    <meta property="og:url" content="https://hakorea.github.io/integrations/mysensors/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="Instructions on how to integrate MySensors sensors into Home Assistant.">
    <meta property="og:image" content="https://hakorea.github.io/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@">
    
    <meta name="twitter:title" content="MySensors">
    <meta name="twitter:description" content="Instructions on how to integrate MySensors sensors into Home Assistant.">
    <meta name="twitter:image" content="https://hakorea.github.io/images/default-social.png">

    <link href="/stylesheets/prism.css?8acb84bc0387c9548a63998fcfea0139" rel="stylesheet">
    <link href="/stylesheets/screen.css?0a23d70030bf362ca935e76ccc50922c" media="screen, projection, print" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="홈어시스턴트" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
  </head>

  <body >

    <header class='site-header'>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="/" class="site-title">
        <img src="/images/home-assistant-logo.png" width="36" height="36" alt="Home Assistant">
        <span>홈어시스턴트</span>
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle">
        <label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
        <ul class="menu pull-right">
            
            <li><a href="/getting-started/">시작하기</a></li>
            <li><a href="/integrations/">통합구성요소</a></li>
            <li><a href="/docs/">문서</a></li>
            <li><a href="/cookbook/">예제</a></li>
            <li><a href='#' class='show-search'><i class="icon-search"></i></a></li>
            <li>KOREAN(not official)</li>
        </ul>
      </nav>

      <div class='search-container' style='display: none'>
        <div class='search'>
          <i class="icon-search"></i>
          <input id='search' placeholder='Search the docs…'>
          <a href='#' class='close'><i class="icon-remove-sign"></i></a>
        </div>
      </div>
    </div>
  </div>
</div>

    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          
            <article class="page">
  
  
    

<div class="edit-github"><a href="https://github.com/hakorea/gitpages_source/blob/master/source/_integrations/mysensors.markdown" rel="external nofollow">깃허브 편집</a></div>


  

  
  <header>
    <h1 class="title indent">
      MySensors
    </h1>
  </header>
  <hr class="divider">
  

  <div class="videoWrapper">
<iframe width="1250" height="713" src="https://www.youtube.com/embed/RwMASJiN7uA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<p><a href="https://www.mysensors.org" rel="external nofollow">MySensors</a> 프로젝트는 Arduino, ESP8266, Raspberry Pi, NRF24L01+, RFM69와 같은 장치를 결합하여 저렴한 센서 네트워크를 구축합니다. 이 통합구성요소는 <a href="#presentation">presentation</a>이 완료된 후 사용 가능한 모든 장치를 Home Assistant에 자동으로 추가합니다. 즉, 장치를 추가하기 위해 설정에 아무것도 추가하지 않아도됩니다. 식별된 장치를 찾으려면 개발자 도구의 <strong>상태</strong> 섹션으로 이동하십시오.</p>
<h3>
<a class="title-link" name="" href="#"></a> 설정</h3>
<p><code>configuration.yaml</code> 파일에 다음을 추가하여 직렬(Serial), 이더넷(LAN) 또는 MQTT MySensors 게이트웨이를 연동하십시오.</p>
<pre><code class="language-yaml"># Example configuration.yaml entry
mysensors:
  gateways:
    - device: '/dev/ttyUSB0'
</code></pre>
<div class="config-vars">
  <h3>
<a class="title-link" name="configuration-variables" href="#configuration-variables"></a> Configuration Variables</h3>
  <dl class="">
<dt>
<a class="title-link" name="gateways" href="#gateways"></a> gateways</dt>
<dd><p class="desc"><span class="type">(<span class="map">map</span>)</span><span class="required">(Required)</span><span class="description"><p>A list of gateways to set up.</p>
</span></p></dd>
<dd><dl class="nested">
<dt>
<a class="title-link" name="device" href="#device"></a> device</dt>
<dd><p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Required)</span><span class="description"><p>The path to the serial gateway where it is connected to your Home Assistant host, or the address of the TCP Ethernet gateway, or <code>mqtt</code> to setup the MQTT gateway. Resolving DNS addresses is theoretically supported but not tested.</p>
</span></p></dd>
<dt>
<a class="title-link" name="baud_rate" href="#baud_rate"></a> baud_rate</dt>
<dd>
<p class="desc"><span class="type">(<span class="integer">integer</span>)</span><span class="required">(Optional)</span><span class="description"><p>Specifies the baud rate of the connected serial gateway.</p>
</span></p>
<p class="default">
Default value: </p>
<p>115200</p>
</dd>
<dt>
<a class="title-link" name="persistence_file" href="#persistence_file"></a> persistence_file</dt>
<dd>
<p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Optional)</span><span class="description"><p>The path to a file to save sensor information. The file extension determines the file type. Currently supported file types are ‘pickle’ and ‘json’.</p>
</span></p>
<p class="default">
Default value: </p>
<p>path/to/config/directory/mysensors.pickle</p>
</dd>
<dt>
<a class="title-link" name="tcp_port" href="#tcp_port"></a> tcp_port</dt>
<dd>
<p class="desc"><span class="type">(<span class="integer">integer</span>)</span><span class="required">(Optional)</span><span class="description"><p>Specifies the port of the connected TCP Ethernet gateway.</p>
</span></p>
<p class="default">
Default value: </p>
<p>5003</p>
</dd>
<dt>
<a class="title-link" name="topic_in_prefix" href="#topic_in_prefix"></a> topic_in_prefix</dt>
<dd><p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Optional)</span><span class="description"><p>Set the prefix of the MQTT topic for messages coming from the MySensors gateway in to Home Assistant.</p>
</span></p></dd>
<dt>
<a class="title-link" name="topic_out_prefix" href="#topic_out_prefix"></a> topic_out_prefix</dt>
<dd><p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Optional)</span><span class="description"><p>Set the prefix of the MQTT topic for messages going from Home Assistant out to the MySensors gateway.</p>
</span></p></dd>
<dt>
<a class="title-link" name="nodes" href="#nodes"></a> nodes</dt>
<dd><p class="desc"><span class="type">(<span class="map">map</span>)</span><span class="required">(Optional)</span><span class="description"><p>A mapping of node ids to node settings, e.g. custom name.</p>
</span></p></dd>
<dd><dl class="nested">
<dt>
<a class="title-link" name="name" href="#name"></a> name</dt>
<dd><p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Required)</span><span class="description"><p>The name the node will be renamed to. This node name becomes part of the entity_id. Default entity_id is [sketch_name]_[node_id]_[child_id] and when this name is set, the entity_id becomes [name]_[child_id].</p>
</span></p></dd>
</dl></dd>
</dl></dd>
<dt>
<a class="title-link" name="persistence" href="#persistence"></a> persistence</dt>
<dd>
<p class="desc"><span class="type">(<span class="integer">integer</span>)</span><span class="required">(Optional)</span><span class="description"><p>Enable or disable local persistence of sensor information. If this is disabled, then each sensor will need to send presentation messages after Home Assistant starts.</p>
</span></p>
<p class="default">
Default value: </p>
<p>true</p>
</dd>
<dt>
<a class="title-link" name="version" href="#version"></a> version</dt>
<dd>
<p class="desc"><span class="type">(<span class="string">string</span>)</span><span class="required">(Optional)</span><span class="description"><p>Specifies the MySensors protocol version to use. Supports versions 1.4 to 2.3.</p>
</span></p>
<p class="default">
Default value: </p>
<p>1.4</p>
</dd>
<dt>
<a class="title-link" name="optimistic" href="#optimistic"></a> optimistic</dt>
<dd>
<p class="desc"><span class="type">(<span class="integer">integer</span>)</span><span class="required">(Optional)</span><span class="description"><p>Enable or disable optimistic mode for actuators (switch/light). Set this to true if no state feedback from actuators is possible. Home Assistant will assume that the command succeeded and change state.</p>
</span></p>
<p class="default">
Default value: </p>
<p>false</p>
</dd>
<dt>
<a class="title-link" name="retain" href="#retain"></a> retain</dt>
<dd>
<p class="desc"><span class="type">(<span class="integer">integer</span>)</span><span class="required">(Optional)</span><span class="description"><p>Enable or disable retain flag for published messages from Home Assistant when using the MQTT gateway.</p>
</span></p>
<p class="default">
Default value: </p>
<p>true</p>
</dd>
</dl>
</div>
<div class="note">
MySensors 2.x의 모든 기능이 아직 Home Assistant에서 지원되는 것은 아닙니다. 더 많은 기능이 추가되면 여기에서 설명서에 설명되어 있습니다. 현재 지원되는 메시지 유형을 보려면 "related components" 아래의 MySensors 플랫폼 페이지로 이동하십시오.
</div>
<p>원래 Arduino를 직렬(Serial) 게이트웨이로 사용하는 경우 포트 이름은 ttyACM*입니다. 정확한 숫자는 아래 표시된 명령으로 확인할 수 있습니다.</p>
<pre><code class="language-bash">$ ls /dev/ttyACM*
</code></pre>
<p>MQTT 게이트웨이를 사용하는 경우 홈어시스턴트에서 <a href="/integrations/mqtt/">MQTT 구성 요소</a>도 설정해야합니다. 최소 MQTT 설정은 아래를 참조하십시오.</p>
<pre><code class="language-yaml">mqtt:
  client_id: home-assistant-1
</code></pre>
<div class="note">
MQTT 게이트웨이에는 MySensors 버전 2.0 이상이 필요하며 MQTT 클라이언트 게이트웨이만 지원됩니다.
</div>
<h3>
<a class="title-link" name="--" href="#--"></a> 확장 설정 예시</h3>
<pre><code class="language-yaml"># Example configuration.yaml entry
mysensors:
  gateways:
    - device: '/dev/ttyUSB0'
      persistence_file: 'path/mysensors.json'
      baud_rate: 38400
      nodes:
        1:
          name: 'kitchen'
        3:
          name: 'living_room'
    - device: '/dev/ttyACM0'
      persistence_file: 'path/mysensors2.json'
      baud_rate: 115200
    - device: '192.168.1.18'
      persistence_file: 'path/mysensors3.json'
      tcp_port: 5003
    - device: mqtt
      persistence_file: 'path/mysensors4.json'
      topic_in_prefix: 'mygateway1-out'
      topic_out_prefix: 'mygateway1-in'
  optimistic: false
  persistence: true
  retain: true
  version: '2.0'
</code></pre>
<h3>
<a class="title-link" name="presentation" href="#presentation"></a> Presentation</h3>
<p>다음 단계에 따라 MySensors 센서 또는 액추에이터를 제시하십시오. :</p>
<ol>
<li>직렬(serial) 게이트웨이를 컴퓨터에 연결하거나 이더넷 또는 MQTT 게이트웨이를 네트워크에 연결하십시오.</li>
<li>
<code>configuration.yaml</code>에서 MySensors 통합구성요소를 설정하십시오.</li>
<li>홈어시스턴트를 시작하십시오.</li>
<li>MySensors 스케치를 작성하여 센서에 업로드하십시오. 다음을 확인하십시오. :
<ul>
<li>sketch 이름을 보내십시오.</li>
<li>센서의 <code>S_TYPE</code>을 제시하십시오.</li>
<li>
<code>V_TYPE</code>당 하나 이상의 초기값을 보냅니다. MySensors 버전 2.x에서는 loop function에서 수행해야합니다. 컨트롤러가 초기값을 받았는지 확인하는 방법에 대한 2.0 예제는 아래를 참조하십시오.</li>
</ul>
</li>
<li>센서를 시작시킵니다.</li>
</ol>
<pre><code class="language-cpp">/*
 * Documentation: https://www.mysensors.org
 * Support Forum: https://forum.mysensors.org
 *
 * https://www.mysensors.org/build/relay
 */

#define MY_DEBUG
#define MY_RADIO_NRF24
#define MY_REPEATER_FEATURE
#define MY_NODE_ID 1
#include &lt;SPI.h&gt;
#include &lt;MySensors.h&gt;
#include &lt;Bounce2.h&gt;

#define RELAY_PIN  5
#define BUTTON_PIN  3
#define CHILD_ID 1
#define RELAY_ON 1
#define RELAY_OFF 0

Bounce debouncer = Bounce();
bool state = false;
bool initialValueSent = false;

MyMessage msg(CHILD_ID, V_STATUS);

void setup()
{
  pinMode(BUTTON_PIN, INPUT_PULLUP);
  debouncer.attach(BUTTON_PIN);
  debouncer.interval(10);

  // Make sure relays are off when starting up
  digitalWrite(RELAY_PIN, RELAY_OFF);
  pinMode(RELAY_PIN, OUTPUT);
}

void presentation()  {
  sendSketchInfo("Relay+button", "1.0");
  present(CHILD_ID, S_BINARY);
}

void loop()
{
  if (!initialValueSent) {
    Serial.println("Sending initial value");
    send(msg.set(state?RELAY_ON:RELAY_OFF));
    Serial.println("Requesting initial value from controller");
    request(CHILD_ID, V_STATUS);
    wait(2000, C_SET, V_STATUS);
  }
  if (debouncer.update()) {
    if (debouncer.read()==LOW) {
      state = !state;
      // Send new state and request ack back
      send(msg.set(state?RELAY_ON:RELAY_OFF), true);
    }
  }
}

void receive(const MyMessage &amp;message) {
  if (message.isAck()) {
     Serial.println("This is an ack from gateway");
  }

  if (message.type == V_STATUS) {
    if (!initialValueSent) {
      Serial.println("Receiving initial value from controller");
      initialValueSent = true;
    }
    // Change relay state
    state = (bool)message.getInt();
    digitalWrite(RELAY_PIN, state?RELAY_ON:RELAY_OFF);
    send(msg.set(state?RELAY_ON:RELAY_OFF));
  }
}
</code></pre>
<h3>
<a class="title-link" name="smartsleep" href="#smartsleep"></a> SmartSleep</h3>
<p>MySensors 버전 2.0-2.1을 사용하여 MySensors 장치에서 Home Assistant로 하트비트(heartbeat) <code>I_HEARTBEAT_RESPONSE</code>를 보내면 Home Assistant에서 SmartSleep 기능이 활성화됩니다. 이는 메시지가 버퍼링되고 장치에서 하트비트를 수신할 때만 장치로 전송됨을 의미합니다. 마지막으로 요청된 상태 변경만 장치로 전송되도록 상태 변경이 저장됩니다. 다른 유형의 메시지는 FIFO 대기열에 대기합니다. SmartSleep은 명령을 기다리는 배터리 구동식 액추에이터에 유용합니다. 하트비트를 전송하고 장치를 절전 모드로 전환하는 방법에 대한 정보는 MySensors 라이브러리 API를 참조하십시오.</p>
<p>MySensors 버전 2.2에서 직렬 API는 SmartSleep 신호로 <code>I_HEARTBEAT_RESPONSE</code>를 사용하는 방식에서, <code>I_PRE_SLEEP_NOTIFICATION</code> 및 <code>I_POST_SLEEP_NOTIFICATION</code> 사용으로 변경되었습니다. MySensors 버전 2.2.x 이상을 사용하는 경우 Home Assistant는 새 메시지 유형을 지원하도록 업그레이드되었으며 <code>I_PRE_SLEEP_NOTIFICATION</code> 타입의 메시지를 수신할 때 SmartSleep을 활성화합니다. Home Assistant가 MySensors 버전 2.0-2.1을 사용하도록 설정된 경우 이전 SmartSleep 동작이 유지됩니다.</p>
<h3>
<a class="title-link" name="--message-validation" href="#--message-validation"></a> 메시지 검증 (Message validation)</h3>
<p>홈어시스턴트와 MySensors 디바이스간에주고받는 메시지는 MySensors <a href="https://www.mysensors.org/download/serial_api_20" rel="external nofollow">직렬 API</a>에 따라 유효성이 검사됩니다. 메시지가 유효성 검사를 통과하지 못하면 메시지가 삭제되고 Home Assistant에 전달되지 않습니다. Arduino 스케치를 작성할 때 사용중인 MySensor 버전의 직렬 API를 따르십시오.</p>
<p>로그는 유효성 검사에 실패했거나 특정 하위 유형에 필요한 하위값이 누락된 메시지를 경고합니다. 홈어시스턴트는 경고 레벨에서 실패한 하위값의 유효성 검사를 기록합니다. 예를들어 플랫폼에 필요한 하나의 필수값 유형이 수신되었지만 다른 필수값 유형이 누락된 경우입니다.</p>
<p>메시지 검증은 Home Assistant 버전 0.52에서 도입되었습니다.</p>
<h3>
<a class="title-link" name="debug-logging" href="#debug-logging"></a> Debug logging</h3>
<p>메시지가 끊어지거나 장치가 Home Assistant에 추가되지 않은 경우 <code>mysensors</code> 통합구성요소와 <code>mysensors</code> 패키지에 대한 디버그 로깅을 켜십시오. 그러면 무슨 일이 일어나고 있는지 알 수 있습니다. github 이슈 트래커에서 <code>mysensors</code> 통합구성요소에 대한 이슈를 보고하는 경우 이 로깅 설정을 사용하여 로그 샘플을 수집하십시오.</p>
<pre><code class="language-yaml">logger:
  default: info
  logs:
    homeassistant.components.mysensors: debug
    mysensors: debug
</code></pre>
<p>자세한 내용은 MySensors의 <a href="https://www.mysensors.org/download" rel="external nofollow">library API</a>를 방문하십시오.</p>


</article>

          
        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">
  
  
    <section class="aside-module grid__item one-whole lap-one-half">

<div class='edit-github'><a href='https://github.com/hakorea/gitpages_source/blob/master/source/_integrations/mysensors.markdown'>깃허브 편집</a></div>

<div class='brand-logo-container section'><img src='/images/supported_brands/mysensors.png' /></div><div class="section">
    <kb-alert-link integration="mysensors"></kb-alert-link>
  </div><div class='section'>
      IoT class<sup><a href='/blog/2016/02/12/classifying-the-internet-of-things/#classifiers'><i class="icon-info-sign"></i></a></sup>: Local Push
    </div><div class='section'>
      Introduced in release: 0.73
    </div><div class='section'>
    Source: <a href='https://github.com/home-assistant/home-assistant/blob/dev/homeassistant/components/mysensors/'>/components/mysensors/</a>
  </div><div class='section'>
    <h1 class="title delta">카테고리</h1>
    <ul class='divided'><li>
        <a href='/integrations/#diy'>DIY</a>
      </li></ul>
    </div></section>

<script src="https://alerts.home-assistant.io/ce-alert-link.js"></script>

  
</div>

        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright grid">
        <div class='company grid__item one-third lap-one-half palm-one-whole'>
          <div class="title">
            <img src="/images/home-assistant-logo.png" width="36" height="36" alt="Home Assistant"> 홈어시스턴트
          </div>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          <ul>
            <li><a href='https://alerts.home-assistant.io'>Home Assistant Alerts</a></li>
            <li><a href='https://cafe.naver.com/koreassistant'>HA 네이버 카페</a></li>
          </ul>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          이 웹사이트는 <a href='https://jekyllrb.com/'>Jekyll</a>과
          <a href='https://github.com/coogie/oscailte'>Oscalite 테마</a>를 사용합니다.
        </div>
      </div>
    </div>
  </div>
</div>

    </footer>

    <script>
var _gaq=[['_setAccount',''],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script src="/javascripts/prism.js?5d6619066a1fc5cd819a93c132b539ac" type="text/javascript"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
docsearch({
  apiKey: 'c762b5632da4220f398f985614f3a1e3',
  indexName: 'hakorea',
  inputSelector: '#search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
document.querySelector('.search .close').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'none';
});
document.querySelector('.show-search').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'block';
  document.getElementById('toggle').checked = false;
  document.querySelector('.search-container input').focus();
});
</script>

  </body>
</html>
