<!doctype html>
  <!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Telegram chatbot - 홈어시스턴트</title>
    <meta name="author" content="Home Assistant">
    <meta name="description" content="Telegram chatbot support">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://hakorea.github.io/integrations/telegram_chatbot/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Telegram chatbot">
    <meta property="og:site_name" content="홈어시스턴트">
    <meta property="og:url" content="https://hakorea.github.io/integrations/telegram_chatbot/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="Telegram chatbot support">
    <meta property="og:image" content="https://hakorea.github.io/images/default-social.png">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@">
    
    <meta name="twitter:title" content="Telegram chatbot">
    <meta name="twitter:description" content="Telegram chatbot support">
    <meta name="twitter:image" content="https://hakorea.github.io/images/default-social.png">

    <link href="/stylesheets/prism.css?8acb84bc0387c9548a63998fcfea0139" rel="stylesheet">
    <link href="/stylesheets/screen.css?0a23d70030bf362ca935e76ccc50922c" media="screen, projection, print" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="홈어시스턴트" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
  </head>

  <body >

    <header class='site-header'>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
      <a href="/" class="site-title">
        <img src="/images/home-assistant-logo.svg" width="36" height="36" alt="Home Assistant">
        <span>홈어시스턴트</span>
      </a>
    </div>

    <div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
      <nav>
        <input type="checkbox" id="toggle">
        <label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
        <ul class="menu pull-right">
            
            <li><a href="/getting-started/">시작하기</a></li>
            <li><a href="/integrations/">통합구성요소</a></li>
            <li><a href="/docs/">문서</a></li>
            <li><a href="/cookbook/">예제</a></li>
            <li>KOREAN(not official)</li>
        </ul>
      </nav>

      <div class='search-container' style='display: none'>
        <div class='search'>
          <i class="icon-search"></i>
          <input id='search' placeholder='Search the docs…'>
          <a href='#' class='close'><i class="icon-remove-sign"></i></a>
        </div>
      </div>
    </div>
  </div>
</div>

    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          
            <article class="page">
  
  
    

<div class="edit-github"><a href="https://github.com/hakorea/hakorea.github.io/tree/current/source/_integrations/telegram_chatbot.markdown" rel="external nofollow">깃허브 편집</a></div>


  

  
  <header>
    <h1 class="title indent">
      Telegram chatbot
    </h1>
  </header>
  <hr class="divider">
  

  <p>Use Telegram on your mobile or desktop device to send and receive messages or commands to/from your Home Assistant.</p>
<p>This integration creates notification services to send, or edit previously sent, messages from a <a href="https://core.telegram.org/bots" rel="external nofollow">Telegram Bot account</a> configured either with the <a href="/integrations/telegram_polling">polling</a> platform or with the <a href="/integrations/telegram_webhooks">webhooks</a> one, and trigger events when receiving messages.</p>
<p>If you don’t need to receive messages, you can use the <a href="/integrations/telegram_broadcast">broadcast</a> platform instead.</p>
<h2>
<a class="title-link" name="notification-services" href="#notification-services"></a> Notification services</h2>
<p>Available services: <code>send_message</code>, <code>send_photo</code>, <code>send_document</code>, <code>send_location</code>, <code>send_sticker</code>, <code>edit_message</code>, <code>edit_replymarkup</code>, <code>edit_caption</code>, <code>answer_callback_query</code>, <code>delete_message</code> and <code>leave_chat</code>.</p>
<h3>
<a class="title-link" name="service-telegram_botsend_message" href="#service-telegram_botsend_message"></a> Service telegram_bot.send_message</h3>
<p>Send a notification.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message</code></td>
<td>no</td>
<td>Message body of the notification.</td>
</tr>
<tr>
<td><code>title</code></td>
<td>yes</td>
<td>Optional title for your notification. Will be composed as ‘%title\n%message’.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>yes</td>
<td>An array of pre-authorized chat_ids or user_ids to send the notification to. Defaults to the first allowed chat_id.</td>
</tr>
<tr>
<td><code>parse_mode</code></td>
<td>yes</td>
<td>Parser for the message text: <code>html</code> or <code>markdown</code>.</td>
</tr>
<tr>
<td><code>disable_notification</code></td>
<td>yes</td>
<td>True/false for send the message silently. iOS users and web users will not receive a notification, Android users will receive a notification with no sound. Defaults to False.</td>
</tr>
<tr>
<td><code>disable_web_page_preview</code></td>
<td>yes</td>
<td>True/false for disable link previews for links in the message.</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom keyboard. <code>[]</code> to reset to no custom keyboard. Example: <code>["/command1, /command2", "/command3"]</code>
</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botsend_photo-and-telegram_botsend_sticker" href="#service-telegram_botsend_photo-and-telegram_botsend_sticker"></a> Service telegram_bot.send_photo and telegram_bot.send_sticker</h3>
<p>Send a photo.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url</code></td>
<td>no</td>
<td>Remote path to an image.</td>
</tr>
<tr>
<td><code>file</code></td>
<td>no</td>
<td>Local path to an image.</td>
</tr>
<tr>
<td><code>caption</code></td>
<td>yes</td>
<td>The title of the image.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>yes</td>
<td>Username for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>yes</td>
<td>Password for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td>yes</td>
<td>Define which authentication method to use. Set to <code>digest</code> to use HTTP digest authentication. Defaults to <code>basic</code>.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>yes</td>
<td>An array of pre-authorized chat_ids or user_ids to send the notification to. Defaults to the first allowed chat_id.</td>
</tr>
<tr>
<td><code>disable_notification</code></td>
<td>yes</td>
<td>True/false for send the message silently. iOS users and web users will not receive a notification, Android users will receive a notification with no sound. Defaults to False.</td>
</tr>
<tr>
<td><code>verify_ssl</code></td>
<td>yes</td>
<td>True/false for checking the SSL certificate of the server for HTTPS URLs. Defaults to True.</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom keyboard. <code>[]</code> to reset to no custom keyboard. Example: <code>["/command1, /command2", "/command3"]</code>
</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botsend_video" href="#service-telegram_botsend_video"></a> Service telegram_bot.send_video</h3>
<p>Send a video.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url</code></td>
<td>no</td>
<td>Remote path to a video.</td>
</tr>
<tr>
<td><code>file</code></td>
<td>no</td>
<td>Local path to a video.</td>
</tr>
<tr>
<td><code>caption</code></td>
<td>yes</td>
<td>The title of the video.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>yes</td>
<td>Username for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>yes</td>
<td>Password for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td>yes</td>
<td>Define which authentication method to use. Set to <code>digest</code> to use HTTP digest authentication. Defaults to <code>basic</code>.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>yes</td>
<td>An array of pre-authorized chat_ids or user_ids to send the notification to. Defaults to the first allowed chat_id.</td>
</tr>
<tr>
<td><code>disable_notification</code></td>
<td>yes</td>
<td>True/false to send the message silently. iOS users and web users will not receive a notification. Android users will receive a notification with no sound. Defaults to False.</td>
</tr>
<tr>
<td><code>verify_ssl</code></td>
<td>yes</td>
<td>True/false for checking the SSL certificate of the server for HTTPS URLs. Defaults to True.</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom keyboard. <code>[]</code> to reset to no custom keyboard. Example: <code>["/command1, /command2", "/command3"]</code>
</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botsend_document" href="#service-telegram_botsend_document"></a> Service telegram_bot.send_document</h3>
<p>Send a document.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>url</code></td>
<td>no</td>
<td>Remote path to a document.</td>
</tr>
<tr>
<td><code>file</code></td>
<td>no</td>
<td>Local path to a document.</td>
</tr>
<tr>
<td><code>caption</code></td>
<td>yes</td>
<td>The title of the document.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>yes</td>
<td>Username for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>yes</td>
<td>Password for a URL which requires HTTP basic authentication.</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td>yes</td>
<td>Define which authentication method to use. Set to <code>digest</code> to use HTTP digest authentication. Defaults to <code>basic</code>.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>yes</td>
<td>An array of pre-authorized chat_ids or user_ids to send the notification to. Defaults to the first allowed chat_id.</td>
</tr>
<tr>
<td><code>disable_notification</code></td>
<td>yes</td>
<td>True/false for send the message silently. iOS users and web users will not receive a notification, Android users will receive a notification with no sound. Defaults to False.</td>
</tr>
<tr>
<td><code>verify_ssl</code></td>
<td>yes</td>
<td>True/false for checking the SSL certificate of the server for HTTPS URLs. Defaults to True.</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom keyboard. <code>[]</code> to reset to no custom keyboard. Example: <code>["/command1, /command2", "/command3"]</code>
</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botsend_location" href="#service-telegram_botsend_location"></a> Service telegram_bot.send_location</h3>
<p>Send a location.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>latitude</code></td>
<td>no</td>
<td>The latitude to send.</td>
</tr>
<tr>
<td><code>longitude</code></td>
<td>no</td>
<td>The longitude to send.</td>
</tr>
<tr>
<td><code>target</code></td>
<td>yes</td>
<td>An array of pre-authorized chat_ids or user_ids to send the notification to. Defaults to the first allowed <code>chat_id</code>.</td>
</tr>
<tr>
<td><code>disable_notification</code></td>
<td>yes</td>
<td>True/false for send the message silently. iOS users and web users will not receive a notification, Android users will receive a notification with no sound. Defaults to False.</td>
</tr>
<tr>
<td><code>keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom keyboard. <code>[]</code> to reset to no custom keyboard. Example: <code>["/command1, /command2", "/command3"]</code>
</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botedit_message" href="#service-telegram_botedit_message"></a> Service telegram_bot.edit_message</h3>
<p>Edit a previously sent message in a conversation.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message_id</code></td>
<td>no</td>
<td>Id of the message to edit. When answering a callback from a pressed button, the id of the origin message is in: <code>{{ trigger.event.data.message.message_id }}</code>. You can use <code>"last"</code> to refer to the last message sent to <code>chat_id</code>.</td>
</tr>
<tr>
<td><code>chat_id</code></td>
<td>no</td>
<td>The chat_id where to edit the message.</td>
</tr>
<tr>
<td><code>message</code></td>
<td>no</td>
<td>Message body of the notification.</td>
</tr>
<tr>
<td><code>title</code></td>
<td>yes</td>
<td>Optional title for your notification. Will be composed as ‘%title\n%message’.</td>
</tr>
<tr>
<td><code>parse_mode</code></td>
<td>yes</td>
<td>Parser for the message text: <code>html</code> or <code>markdown</code>.</td>
</tr>
<tr>
<td><code>disable_web_page_preview</code></td>
<td>yes</td>
<td>True/false for disable link previews for links in the message.</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botedit_caption" href="#service-telegram_botedit_caption"></a> Service telegram_bot.edit_caption</h3>
<p>Edit the caption of a previously sent message.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message_id</code></td>
<td>no</td>
<td>Id of the message to edit. When answering a callback from a pressed button, the id of the origin message is in: <code>{{ trigger.event.data.message.message_id }}</code>. You can use <code>"last"</code> to refer to the last message sent to <code>chat_id</code>.</td>
</tr>
<tr>
<td><code>chat_id</code></td>
<td>no</td>
<td>The chat_id where to edit the caption.</td>
</tr>
<tr>
<td><code>caption</code></td>
<td>no</td>
<td>Message body of the notification.</td>
</tr>
<tr>
<td><code>disable_web_page_preview</code></td>
<td>yes</td>
<td>True/false for disable link previews for links in the message.</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botedit_replymarkup" href="#service-telegram_botedit_replymarkup"></a> Service telegram_bot.edit_replymarkup</h3>
<p>Edit the inline keyboard of a previously sent message.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message_id</code></td>
<td>no</td>
<td>Id of the message to edit. When answering a callback from a pressed button, the id of the origin message is in: <code>{{ trigger.event.data.message.message_id }}</code>. You can use <code>"last"</code> to refer to the last message sent to <code>chat_id</code>.</td>
</tr>
<tr>
<td><code>chat_id</code></td>
<td>no</td>
<td>The chat_id where to edit the reply_markup.</td>
</tr>
<tr>
<td><code>disable_web_page_preview</code></td>
<td>yes</td>
<td>True/false for disable link previews for links in the message.</td>
</tr>
<tr>
<td><code>inline_keyboard</code></td>
<td>yes</td>
<td>List of rows of commands, comma-separated, to make a custom inline keyboard with buttons with associated callback data. Example: <code>["/button1, /button2", "/button3"]</code> or <code>[[["Text btn1", "/button1"], ["Text btn2", "/button2"]], [["Text btn3", "/button3"]]]</code>
</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botanswer_callback_query" href="#service-telegram_botanswer_callback_query"></a> Service telegram_bot.answer_callback_query</h3>
<p>Respond to a callback query originated by clicking on an online keyboard button. The answer will be displayed to the user as a notification at the top of the chat screen or as an alert.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message</code></td>
<td>no</td>
<td>Unformatted text message body of the notification.</td>
</tr>
<tr>
<td><code>callback_query_id</code></td>
<td>no</td>
<td>Unique id of the callback response. In the <code>telegram_callback</code> event data: <code>{{ trigger.event.data.id }}</code>
</td>
</tr>
<tr>
<td><code>show_alert</code></td>
<td>yes</td>
<td>True/false for show a permanent notification. Defaults to False.</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botdelete_message" href="#service-telegram_botdelete_message"></a> Service telegram_bot.delete_message</h3>
<p>Delete a previously sent message in a conversation.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message_id</code></td>
<td>no</td>
<td>Id of the message to delete. When answering a callback from a pressed button, the id of the origin message is in: <code>{{ trigger.event.data.message.message_id }}</code>. You can use <code>"last"</code> to refer to the last message sent to <code>chat_id</code>.</td>
</tr>
<tr>
<td><code>chat_id</code></td>
<td>no</td>
<td>The chat_id where to delete the message.</td>
</tr>
</tbody>
</table>
<h3>
<a class="title-link" name="service-telegram_botleave_chat" href="#service-telegram_botleave_chat"></a> Service telegram_bot.leave_chat</h3>
<p>Remove the bot from the chat group where it was added.</p>
<table>
<thead>
<tr>
<th>Service data attribute</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chat_id</code></td>
<td>no</td>
<td>The chat_id from where to remove the bot.</td>
</tr>
</tbody>
</table>
<h2>
<a class="title-link" name="telegram-notification-platform" href="#telegram-notification-platform"></a> telegram notification platform</h2>
<p>The <a href="/integrations/telegram"><code>telegram</code> notification platform</a> requires the <code>telegram_bot</code> integration to work with, and it’s designed to generate a customized shortcut (<code>notify.USERNAME</code>) to send notifications (messages, photos, documents and locations) to a particular <code>chat_id</code> with the old syntax, allowing backward compatibility.</p>
<p>The required YAML configuration now reduces to:</p>
<pre><code class="language-yaml">notify:
  - name: NOTIFIER_NAME
    platform: telegram
    chat_id: USER_CHAT_ID
</code></pre>
<h2>
<a class="title-link" name="event-triggering" href="#event-triggering"></a> Event triggering</h2>
<p>A command looks like <code>/thecommand</code> or <code>/othercommand with some args</code>.</p>
<p>When received by Home Assistant it will fire a <code>telegram_command</code> event on the event bus with the following <code>event_data</code>:</p>
<pre><code class="language-yaml">command: "/thecommand"
args: "&lt;any other text following the command&gt;"
from_first: "&lt;first name of the sender&gt;"
from_last: "&lt;last name of the sender&gt;"
user_id: "&lt;id of the sender&gt;"
chat_id: "&lt;origin chat id&gt;"
chat: "&lt;chat info&gt;"
</code></pre>
<p>Any other message not starting with <code>/</code> will be processed as simple text, firing a <code>telegram_text</code> event on the event bus with the following <code>event_data</code>:</p>
<pre><code class="language-yaml">text: "some text received"
from_first: "&lt;first name of the sender&gt;"
from_last: "&lt;last name of the sender&gt;"
user_id: "&lt;id of the sender&gt;"
chat_id: "&lt;origin chat id&gt;"
chat: "&lt;chat info&gt;"
</code></pre>
<p>If the message is sent from a <a href="https://core.telegram.org/bots#inline-keyboards-and-on-the-fly-updating" rel="external nofollow">press from an inline button</a>, for example, a callback query is received, and Home Assistant will fire a <code>telegram_callback</code> event with:</p>
<pre><code class="language-yaml">data: "&lt;data associated to action callback&gt;"
message: &lt;message origin of the action callback&gt;
from_first: "&lt;first name of the sender&gt;"
from_last: "&lt;last name of the sender&gt;"
user_id: "&lt;id of the sender&gt;"
id: "&lt;unique id of the callback&gt;"
chat_instance: "&lt;chat instance&gt;"
chat_id: "&lt;origin chat id&gt;"
</code></pre>
<h3>
<a class="title-link" name="configuration-samples" href="#configuration-samples"></a> Configuration samples</h3>
<p>Simple ping pong example.</p>
<pre><code class="language-yaml">alias: 'Telegram bot that reply pong to ping'
trigger:
  platform: event
  event_type: telegram_command
  event_data:
    command: '/ping'
action:
  - service: notify.notify
    data:
      message: 'pong'
</code></pre>
<p>An example that shows keyboard interaction with <code>notify.telegram</code></p>
<pre><code class="language-yaml">trigger:
  platform: event
  event_type: telegram_command
  event_data:
    command: '/start'
action:
  - service: notify.telegram
    data:
      message: 'commands'
      data:
        keyboard:
          - '/ping, /alarm'
          - '/siren'
</code></pre>
<p>and an automation to trigger a related command “/siren”.</p>
<pre><code class="language-yaml">trigger:
  platform: event
  event_type: telegram_command
  event_data:
    command: '/siren'
action:
  - service: homeassistant.turn_on
    entity_id: switch.vision_zm1601eu5_battery_operated_siren_switch_9_0
  - delay:
      seconds: 10
  - service: homeassistant.turn_off
    entity_id: switch.vision_zm1601eu5_battery_operated_siren_switch_9_0
</code></pre>
<p>An example to show the use of event_data in action:</p>
<pre><code class="language-yaml">- alias: 'Kitchen Telegram Speak'
  trigger:
    platform: event
    event_type: telegram_command
    event_data:
      command: '/speak'
  action:
    - service: notify.kitchen_echo
      data_template:
        message: &gt;
          Message from {{ trigger.event.data["from_first"] }}. {% for state in trigger.event.data["args"] %} {{ state }} {% endfor %}
</code></pre>
<h3>
<a class="title-link" name="sample-automations-with-callback-queries-and-inline-keyboards" href="#sample-automations-with-callback-queries-and-inline-keyboards"></a> Sample automations with callback queries and inline keyboards</h3>
<p>A quick example to show some of the callback capabilities of inline keyboards with a dumb automation consisting in a simple repeater of normal text that presents an inline keyboard with 3 buttons: ‘EDIT’, ‘NO’ and ‘REMOVE BUTTON’:</p>
<ul>
<li>Pressing ‘EDIT’ changes the sent message.</li>
<li>Pressing ‘NO’ only shows a brief notification (answering the callback query).</li>
<li>Pressing ‘REMOVE BUTTON’ changes the inline keyboard removing that button.</li>
</ul>
<p>Text repeater:</p>
<pre><code class="language-yaml">- alias: 'Telegram bot that repeats text'
  trigger:
    platform: event
    event_type: telegram_text
  action:
    - service: telegram_bot.send_message
      data_template:
        title: '*Dumb automation*'
        target: '{{ trigger.event.data.user_id }}'
        message: 'You said: {{ trigger.event.data.text }}'
        disable_notification: true
        inline_keyboard:
          - "Edit message:/edit_msg, Don't:/do_nothing"
          - "Remove this button:/remove button"
</code></pre>
<p>Message editor:</p>
<pre><code class="language-yaml">- alias: 'Telegram bot that edits the last sent message'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      command: '/edit_msg'
  action:
    - service: telegram_bot.answer_callback_query
      data_template:
        callback_query_id: '{{ trigger.event.data.id }}'
        message: 'Editing the message!'
        show_alert: true
    - service: telegram_bot.edit_message
      data_template:
        message_id: '{{ trigger.event.data.message.message_id }}'
        chat_id: '{{ trigger.event.data.chat_id }}'
        title: '*Message edit*'
        inline_keyboard:
          - "Edit message:/edit_msg, Don't:/do_nothing"
          - "Remove this button:/remove button"
        message: &gt;
          Callback received from {{ trigger.event.data.from_first }}.
          Message id: {{ trigger.event.data.message.message_id }}.
          Data: {{ trigger.event.data.data }}
</code></pre>
<p>Keyboard editor:</p>
<pre><code class="language-yaml">- alias: 'Telegram bot that edits the keyboard'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      command: '/remove button'
  action:
    - service: telegram_bot.answer_callback_query
      data_template:
        callback_query_id: '{{ trigger.event.data.id }}'
        message: 'Callback received for editing the inline keyboard!'
    - service: telegram_bot.edit_replymarkup
      data_template:
        message_id: 'last'
        chat_id: '{{ trigger.event.data.chat_id }}'
        inline_keyboard:
          - "Edit message:/edit_msg, Don't:/do_nothing"
</code></pre>
<p>Only acknowledges the ‘NO’ answer:</p>
<pre><code class="language-yaml">- alias: 'Telegram bot that simply acknowledges'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      command: '/do_nothing'
  action:
    - service: telegram_bot.answer_callback_query
      data_template:
        callback_query_id: '{{ trigger.event.data.id }}'
        message: 'OK, you said no!'
</code></pre>
<p>Telegram callbacks also support arguments and commands the same way as normal messages.</p>
<pre><code class="language-yaml">- alias: 'Telegram bot repeats arguments on callback query'
  trigger:
    platform: event
    event_type: telegram_callback
    event_data:
      command: '/repeat'
  action:
    - service: telegram_bot.answer_callback_query
      data_template:
        show_alert: true
        callback_query_id: '{{ trigger.event.data.id }}'
        message: 'I repeat: {{trigger.event.data["args"]}}'
</code></pre>
<p>In this case, having a callback with <code>/repeat 1 2 3</code> with pop a notification saying <code>I repeat: [1, 2, 3]</code></p>
<p>For a more complex usage of the <code>telegram_bot</code> capabilities, using <a href="/docs/ecosystem/appdaemon/tutorial/">AppDaemon</a> is advised.</p>
<p>This is how the previous 4 automations would be through a simple AppDaemon app:</p>
<pre><code class="language-python">import appdaemon.plugins.hass.hassapi as hass


class TelegramBotEventListener(hass.Hass):
    """Event listener for Telegram bot events."""

    def initialize(self):
        """Listen to Telegram Bot events of interest."""
        self.listen_event(self.receive_telegram_text, "telegram_text")
        self.listen_event(self.receive_telegram_callback, "telegram_callback")

    def receive_telegram_text(self, event_id, payload_event, *args):
        """Text repeater."""
        assert event_id == "telegram_text"
        user_id = payload_event["user_id"]
        msg = "You said: ``` %s ```" % payload_event["text"]
        keyboard = [
            [("Edit message", "/edit_msg"), ("Don't", "/do_nothing")],
            [("Remove this button", "/remove button")],
        ]
        self.call_service(
            "telegram_bot/send_message",
            title="*Dumb automation*",
            target=user_id,
            message=msg,
            disable_notification=True,
            inline_keyboard=keyboard,
        )

    def receive_telegram_callback(self, event_id, payload_event, *args):
        """Event listener for Telegram callback queries."""
        assert event_id == "telegram_callback"
        data_callback = payload_event["data"]
        callback_id = payload_event["id"]
        chat_id = payload_event["chat_id"]
        # keyboard = ["Edit message:/edit_msg, Don't:/do_nothing",
        #             "Remove this button:/remove button"]
        keyboard = [
            [("Edit message", "/edit_msg"), ("Don't", "/do_nothing")],
            [("Remove this button", "/remove button")],
        ]

        if data_callback == "/edit_msg":  # Message editor:
            # Answer callback query
            self.call_service(
                "telegram_bot/answer_callback_query",
                message="Editing the message!",
                callback_query_id=callback_id,
                show_alert=True,
            )

            # Edit the message origin of the callback query
            msg_id = payload_event["message"]["message_id"]
            user = payload_event["from_first"]
            title = "*Message edit*"
            msg = "Callback received from %s. Message id: %s. Data: ``` %s ```"
            self.call_service(
                "telegram_bot/edit_message",
                chat_id=chat_id,
                message_id=msg_id,
                title=title,
                message=msg % (user, msg_id, data_callback),
                inline_keyboard=keyboard,
            )

        elif data_callback == "/remove button":  # Keyboard editor:
            # Answer callback query
            self.call_service(
                "telegram_bot/answer_callback_query",
                message="Callback received for editing the " "inline keyboard!",
                callback_query_id=callback_id,
            )

            # Edit the keyboard
            new_keyboard = keyboard[:1]
            self.call_service(
                "telegram_bot/edit_replymarkup",
                chat_id=chat_id,
                message_id="last",
                inline_keyboard=new_keyboard,
            )

        elif data_callback == "/do_nothing":  # Only Answer to callback query
            self.call_service(
                "telegram_bot/answer_callback_query",
                message="OK, you said no!",
                callback_query_id=callback_id,
            )
</code></pre>


</article>

          
        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">
  
  
    <section class="aside-module grid__item one-whole lap-one-half">

<div class='edit-github'><a href='https://github.com/hakorea/hakorea.github.io/tree/current/source/_integrations/telegram_chatbot.markdown'>깃허브 편집</a></div>

<div class='brand-logo-container section'><img src='/images/supported_brands/telegram.png' /></div><div class="section">
    <kb-alert-link integration="telegram_chatbot"></kb-alert-link>
  </div><div class='section'>
      IoT class<sup><a href='/blog/2016/02/12/classifying-the-internet-of-things/#classifiers'><i class="icon-info-sign"></i></a></sup>: Cloud Push
    </div><div class='section'>
      Introduced in release: 0.42
    </div><div class='section'>
    Source: <a href='https://github.com/home-assistant/home-assistant/blob/dev/homeassistant/components/telegram_chatbot/'>/components/telegram_chatbot/</a>
  </div><div class='section'>
    <h1 class="title delta">카테고리</h1>
    <ul class='divided'><li>
        <a href='/integrations/#hub'>Hub</a>
      </li></ul>
    </div></section>

<script src="https://alerts.home-assistant.io/ce-alert-link.js"></script>

  
</div>

        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright grid">
        <div class='company grid__item one-third lap-one-half palm-one-whole'>
          <div class="title">
            <img width="40" src="/images/favicon-192x192-full.png" alt="Home Assistant"> 홈어시스턴트
          </div>
          <div class="icons">
            <a rel="me" href='https://twitter.com/home_assistant' title="Twitter"><i class="icon-twitter"></i></a>
            <a rel="me" href='https://www.facebook.com/homeassistantio' title="Facebook"><i class="icon-facebook"></i></a>
            <a rel="me" href='https://github.com/home-assistant/home-assistant' title="GitHub"><i class="icon-github"></i></a>
          </div>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          <ul>
            <li><a href='https://alerts.home-assistant.io'>Home Assistant Alerts</a></li>
            <li><a href='https://developers.home-assistant.io'>Developers</a></li>
            <li><a href='https://data.home-assistant.io'>Data Science</a></li>
            <li><a href='mailto:hello@home-assistant.io'>Contact</a> (no support!)</li>
            <li><a href='/security/'>Security Vulnerabilities</a></li>
            <li><a href='/privacy/'>Privacy</a></li>
            <li><a href='https://status.home-assistant.io'>System Status</a></li>
          </ul>
        </div>

        <div class='grid__item one-third lap-one-half palm-one-whole'>
          이 웹사이트는 <a href='https://jekyllrb.com/'>지킬</a>과
          <a href='https://github.com/coogie/oscailte'>Oscalite 테마</a>를 사용합니다.
          Hosted by <a href='https://www.netlify.com/'>Netlify</a>.
        </div>
      </div>
    </div>
  </div>
</div>

    </footer>

    <script>
var _gaq=[['_setAccount',''],['_trackPageview']];
(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script src="/javascripts/prism.js?5d6619066a1fc5cd819a93c132b539ac" type="text/javascript"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript">
docsearch({
  apiKey: 'ae96d94b201c5444c8a443093edf3efb',
  indexName: 'home-assistant',
  inputSelector: '#search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
document.querySelector('.search .close').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'none';
});
document.querySelector('.show-search').addEventListener('click', function(ev) {
  ev.preventDefault();
  document.querySelector('.search-container').style.display = 'block';
  document.getElementById('toggle').checked = false;
  document.querySelector('.search-container input').focus();
});
</script>

  </body>
</html>
